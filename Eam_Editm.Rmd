---
title: "Management and Organizational Practices Survey - Colombia 2017-2018"
author: "Leonardo Iacovone / Javier Fernandez"
date: "8/24/2020"
output:
  pdf_document: default
  word_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r LIBRARIES AND AVERAGES OF MANAGEMENT, fig.show='hide', message=FALSE, warning=FALSE, include=FALSE, results='hide'}

# LIBRARIES AND AVERAGES OF MANAGEMENT

#install.packages("stargazer")
#install.packages("tidyverse")
#install.packages("ggplot2")
#install.packages("dplyr")
#install.packages("kableExtra")
#install.packages("xtable")
#install.packages("knitr")
#install.packages("papeR")
#install.packages("devtools")
#install.packages("tinytex")
#tinytex::install_tinytex()
#tinytex:::install_prebuilt()
#tinytex::install_tinytex()
#devtools::install_github('yihui/tinytex')
#tinytex::reinstall_tinytex()
library(tinytex)
#update.packages(ask = FALSE, checkBuilt = TRUE)
#tinytex::tlmgr_update()
options(tinytex.verbose = TRUE)
#install.packages("booktabs")
#install.packages("miceadds")
#install.packages("xlsx")
#install.packages("StatMeasures")
library(StatMeasures)
#install.packages("scales")
library(scales)


library(tidyverse)
library(ggplot2)
library(stargazer)
library(dplyr)
library(kableExtra)
library(xtable)
library("knitr")
library("papeR")
library("devtools")
require(plyr)
#install.packages("IDPmisc")
library(IDPmisc)
library(lmtest)
library(estimatr)
library(plm)
library(fastDummies)
library(texreg)
library(fixest)
library(miceadds)
#library("xlsx")
#install.packages("expss")
library(expss)
library(data.table)
#devtools::install_github("haozhu233/kableExtra")


library(haven)
Edit_2017_2018_1 <- read_dta("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/Edit 2017_2018_recoded.dta")


####Cleaning for managers-frequency review. If No key performance indicators (from question 2), question 3 will be zero
#(if VIII5R1C1_new=0 (Dane:VIII5R1C1=5), VIII6R1C1_new,VIII7R1C1_new, VIII8R1C1_new should be = 0)

Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
  mutate(VIII6R1C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R1C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
  mutate(VIII6R2C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R2C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
  mutate(VIII6R3C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R3C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
  mutate(VIII6R4C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R4C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
  mutate(VIII6R5C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R5C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
  mutate(VIII6R6C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R6C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
  mutate(VIII6R7C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R7C1_new))

#Cleaning for no-managers-frequency-review. If No key performance indicators (from question 2), question 4 will be zero 
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
  mutate(VIII7R1C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R1C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
  mutate(VIII7R2C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R2C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
  mutate(VIII7R3C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R3C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
  mutate(VIII7R4C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R4C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
  mutate(VIII7R5C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R5C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
  mutate(VIII7R6C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R6C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
  mutate(VIII7R7C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R7C1_new))


#### AVERAGE score for managers-frequency review, question 3

Edit_2017_2018_1$VIII6_new_avg_score = rowMeans(Edit_2017_2018_1[,c(680,681,682,683,684,685,686)],na.rm = TRUE)

#### AVERAGE score for no Managers-frequency review, question 4

Edit_2017_2018_1$VIII7_new_avg_score = rowMeans(Edit_2017_2018_1[,c(687,688,689,690,691,692,693)],na.rm = TRUE)


#### AVERAGE score for non-managers’ performance bonuses based on, question 9
Edit_2017_2018_1$VIII12_new_avg_score = rowMeans(Edit_2017_2018_1[,c(700,701,702,703,704)],na.rm = TRUE)

#### AVERAGE score for managers’ performance bonuses usually based on, question 11
Edit_2017_2018_1$VIII14_new_avg_score = rowMeans(Edit_2017_2018_1[,c(706,707,708,709,710)],na.rm = TRUE)
Edit_2017_2018_1$VIII10R1C1_new <- replace(Edit_2017_2018_1$VIII10R1C1_new, Edit_2017_2018_1$VIII10R1C1_new == 6, NA)

#VIII19R1C1, question property
Edit_2017_2018_1$property<-as.character(Edit_2017_2018_1$VIII1R1C1)
Edit_2017_2018_1$property<-revalue(Edit_2017_2018_1$property,c("1"="Founder","2"="Founder's Familiy","3"="Other"))
#Edit_2017_2018_1$property<-as.numeric(Edit_2017_2018_1$property)

#this lines to identify number of column and variable
#data.frame(colnames(Edit_2017_2018_1))

#variable:column number:question number (1-16 - Bloom (2019))
# VIII4R1C1_new=678=q1, VIII5R1C1_new=679=q2,VIII6_new_avg_score=694=q3,VIII7_new_avg_score=695=q4,VIII8R1C1_new=696=q5
#VIII9R1C1_new=697=q6,VIII10R1C1_new=698=q7,VIII11R1C1_new=699=q8,VIII12_new_avg_score=716=q9,VIII13R1C1_new=705=q10
# VIII14_new_avg_score=717=q11,VIII15R1C1_new=711=q12,VIII16R1C1_new=712=q13,VIII17R1C1_new=713=q14,
#VIII18R1C1_new=714=q15,VIII19R1C1_new=715=q16

# counting missing values accross 16 questions
Edit_2017_2018_1$na_16_q<-rowSums(is.na(Edit_2017_2018_1[, c(678,679,694,695,696,697,698,699,716,705,717,711,712,713,714,715)]))

#filtering the data set: From 16 Bloom Questions,at least 11 non-missing values (max 5 missing values)
Edit_2017_2018_2 <- Edit_2017_2018_1[Edit_2017_2018_1$na_16_q <=5,]

#Management Score, Non-incentives and incentives questions

# 1. Total Average (16 questions)
Edit_2017_2018_2$Management = rowMeans(Edit_2017_2018_2[,c(678,679,694,695,696,697,698,699,716,705,717,711,712,713,714,715)],na.rm = TRUE)

# 2.Non-incentives average (1-8 questions)

Edit_2017_2018_2$avg_non_inc_q = rowMeans(Edit_2017_2018_2[,c(678,679,694,695,696,697,698,699)],na.rm = TRUE)

# 3.Incentives average (9-16 questions)

Edit_2017_2018_2$avg_inc_q = rowMeans(Edit_2017_2018_2[,c(716,705,717,711,712,713,714,715)],na.rm = TRUE)

management_edit<-Edit_2017_2018_2[ ,c("NORDEMP","Management","avg_non_inc_q","avg_inc_q")]

write_dta(management_edit,"~/Google Drive/Internship_WB_Summer/Edit/Github/management_edit.dta")

```

# Summary 

Matching the Innovation and Technology Survey EDIT 2017-2018 (acronym in Spanish) with Annual Manufacturing Survey 2018 (EAM), we analyze the relationship between the performance and management at firm level for Colombia in 2018. The management is a significant driver of variation in productivity, development and innovation (R&Di). Also, a statistically significant relationship is observed for the number of export destinations, products and export revenues. 


```{r Data Frame for Descriptive Statistics and filters for location (department: dpto), fig.show='hide', message=FALSE, warning=FALSE, include=FALSE, results='hide'}

#Data Frame for Descriptive Statistics and filters for location (department: dpto)

library(haven)
#reading Annual Manufacturing Survey from Colombia
Eam_2018_1 <- read_dta("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/EAM_2018_30june.dta")

###proportion of multiplants
count_nordemp_eam<-data.frame(count(Eam_2018_1,"nordemp"))

count_nordemp_eam<-count_nordemp_eam %>%
   mutate(Multiplant = if_else(freq >1, 1,0))

##dataframe for stargazer
df0<-data.frame(Edit_2017_2018_2$NORDEMP,Edit_2017_2018_2$Management,Edit_2017_2018_2$avg_non_inc_q,Edit_2017_2018_2$avg_inc_q,Edit_2017_2018_2$IV1R11C2)

colnames(df0)[1] <- "nordemp"
colnames(df0)[2] <- "Management (1-16)"
colnames(df0)[3] <- "No Incentives (1-8)"
colnames(df0)[4] <- "Incentives (9-16)"
colnames(df0)[5]<-"Size(Firm employment)"


df0 <- merge(df0,count_nordemp_eam,by="nordemp",all=FALSE)

#selection variables: dpto,ciiu4
dpto_ciiu4<-subset(Eam_2018_1,select=c(nordemp,dpto,ciiu4,VALORVEN))
#Filter for uniplants: firms with just one NORDEMP (one plant)
# counting 
count_dpto_ciiu4<-data.frame(count(dpto_ciiu4,"nordemp"))
# uniplant=1, multiplant=0 (else)
count_dpto_ciiu4<-count_dpto_ciiu4 %>%
   mutate(uniplant = if_else(freq =="1", 1,0))
#filter for uniplant
uniplant_filter<-count_dpto_ciiu4[!(count_dpto_ciiu4$uniplant=="0"),]
#dpto and ciiu4 for uniplants
uniplant_filter<-merge(uniplant_filter,dpto_ciiu4,by="nordemp",all.x = TRUE)

#Filter for multiplants
multiplant_filter<-count_dpto_ciiu4[(count_dpto_ciiu4$uniplant=="0"),]
#Indicator of multiplant
dpto_ciiu4<-merge(dpto_ciiu4,multiplant_filter,by="nordemp", all.x = TRUE)
#filter for multiplants
multiplant_filter<-NaRV.omit(dpto_ciiu4)


#pivot table with max of VALORVEN from multiplant_filter: 
multiplant_filter<-multiplant_filter%>% 
      group_by(nordemp) %>% 
      filter(VALORVEN==max(VALORVEN))
colnames(multiplant_filter)[1] <- "NORDEMP"
multiplant_filter<-multiplant_filter[!duplicated(multiplant_filter$NORDEMP), ]
#subset variables in order to use rbind
uniplant_filter<-subset(uniplant_filter,select=-c(VALORVEN,freq,uniplant))
colnames(uniplant_filter)[1]<-"NORDEMP"
multiplant_filter<-subset(multiplant_filter,select=-c(VALORVEN,freq,uniplant))
uniplant_filter<-data.frame(uniplant_filter)
multiplant_filter<-data.frame(multiplant_filter)
###new ciiu4 and dpto
dpto_ciiu4_unique<-rbind(multiplant_filter, uniplant_filter)


```

## Introduction



## Management and Organizational Practices Survey in Colombia

The Management and Organizational Practices Survey was incorporated for the first time in EDIT 2017 2018 (Innovation and Technology Survey in Colombia for Manufacturing Sector) and published with anonymous data on the website of the Colombian Institute of Statistics (DANE). The EDIT included 16 management questions with two basic areas, which are supported on the idea of the continuous improvement. For our regressions, we aggregate those 16 questions into a single measure, which is called the management score. This score is the unweighted average, where the answer to each question is measured on a scale from 0 to 1. 

For our regressions, we aggregate those 16 questions into a single measure, which is called the management score. This score is the unweighted average, where the answer to each question is measured on a scale from 0 to 1, where o is the worst option and 1 the best. Table 1 presents the descriptive statistics of the successful merge between EDIT and EAM, and some characteristics at the signature level. In cases where the firm has more than one establishment, the information is added. For our analysis, we use data with at least eleven non-missing responses to the management questions that also have positive values for outcomes and inputs of the firm. 

The histogram below shows the distribution for magement score (16 questions). As you can see, the distribution is skewed to the left, where the total number of observations is 7,529 in EDIT. This histogram includes all observations with at least 11 non-missing responses to management questions.

```{r Histogram Colombia - USA with only EDIT data, fig.show='hide', message=FALSE, warning=FALSE, include=FALSE, results='hide'}

# Histogram Colombia - USA with only EDIT data

my.hist1<-hist(Edit_2017_2018_2$Management, ylab ="Probability", breaks=20)

my.hist1$counts
mycount1<-data.frame(my.hist1$counts)

score_bar<-data.frame(c("0.05","0.1","0.15","0.2","0.25","0.3","0.35","0.4","0.45","0.5","0.55","0.6","0.65","0.7","0.75","0.8","0.85","0.9","0.95","1"))
colnames(score_bar)[1]<-"Score"
usa_freq <-data.frame(c("0.0011","0.0016","0.0041","0.0131","0.0191","0.0251","0.0311","0.0451","0.0581", "0.0641", "0.0883", "0.0961", "0.1201","0.1161","0.1131","0.0951","0.0561","0.0221","0.0281","0.0024"))
colnames(usa_freq)[1] <- "USA"
col_freq1 <- prop.table(mycount1)
colnames(col_freq1)[1] <- "Colombia"


#df <- data.frame(, second_column)
my_over_hist1<-data.frame(score_bar,usa_freq,col_freq1)

my_over_hist1$Score<-as.numeric(as.character(unlist(my_over_hist1[[1]])))
my_over_hist1$USA<-as.numeric(as.character(unlist(my_over_hist1[[2]])))
my_over_hist1$Colombia<-as.numeric(as.character(unlist(my_over_hist1[[3]])))
#typeof(my_over_hist$Colombia)

# Plot comparing USA and Colombia Scores with all EDIT observations

library(ggplot2)

ggplot(data=my_over_hist1,aes(x=Score))+
  geom_bar(aes(y=Colombia),stat="identity",position ="identity",alpha=.5,fill='black',color='red') +
  geom_bar(aes(y=USA),stat="identity",position ="identity",alpha=.5,fill='white',color='blue')+ 
  labs(title = "Manegement - Colombia vs USA with only EDIT data",
       x="Score: Colombia(red) - USA(blue)",
       y="Share")+theme(plot.title = element_text(hjust = 0.5))+theme(plot.title = element_text(hjust = 0.5))

```

```{r Descriptive Statistics (2), fig.show='hide', message=FALSE, warning=FALSE, include=FALSE, results='hide'}

# Descriptive Statistics (2)

#aggregating by nordemp and summing dpto or more.
# As a result, the new variable is Group.1 (KEY) instead nordemp (Nominal change) and the aggregated variable is x instead dpto.
Eam_2018_2<-aggregate(list(Eam_2018_1$CONSIN2, Eam_2018_1$ACTIVFI,Eam_2018_1$PERTOTAL,Eam_2018_1$PRODBR2,Eam_2018_1$c7c4r14,Eam_2018_1$VALAGRI,Eam_2018_1$PRESPYTE,Eam_2018_1$SALPEYTE,Eam_2018_1$VALORVEN,Eam_2018_1$VALORCOM,Eam_2018_1$VALORCX,Eam_2018_1$PORCVT), by=list(Eam_2018_1$nordemp),FUN=sum,na.rm=TRUE) #, na.rm=FALSE

#ascendent order on Group.1, it is optional becaise the aggregate function returns a ascendent Group.1 (KEY) 
#Eam_2018_3<- Eam_2018_2[order(Eam_2018_2$x),]
#testing a specific value on a variable
#any(Eam_2018_3$Group.1==141465)

# returns the variable names easily
#data.frame(colnames(Eam_2018_2))

#changing names
colnames(Eam_2018_2)[1] <- "NORDEMP"
colnames(Eam_2018_2)[2] <- "intinput"
colnames(Eam_2018_2)[3] <- "fixedassets"
colnames(Eam_2018_2)[4] <- "empltot"
colnames(Eam_2018_2)[5] <- "valprod"
colnames(Eam_2018_2)[6] <- "valitc"
colnames(Eam_2018_2)[7]<-"valueadded"
colnames(Eam_2018_2)[8]<-"benefits"
colnames(Eam_2018_2)[9]<-"wages"
colnames(Eam_2018_2)[10]<-"sales"
colnames(Eam_2018_2)[11]<-"raw_material"
colnames(Eam_2018_2)[12]<-"raw_material_m"
colnames(Eam_2018_2)[13]<-"sales_x"


#typeof(Eam_2018_2$dpto)
#typeof(Eam_2018_2$periodo)
#summarise(Eam_2018_2)

#Natural join (all=FALSE, only intersection)
total <- merge(Edit_2017_2018_2,Eam_2018_2,by="NORDEMP",all=FALSE)
#Natural join with ciiu4 and dto
total<-merge(total,dpto_ciiu4_unique,by="NORDEMP",all=FALSE)


n<-data.frame(Database=c("EDIT 1:All observations","EDIT 2:At least 11 non-missing values","EAM 1:All observations","EAM 2:Collapsed data","Merge EDIT 2 - EAM 2"),n=c(nrow(Edit_2017_2018_1),nrow(Edit_2017_2018_2),nrow(Eam_2018_1),nrow(Eam_2018_2),nrow(total)))
#kable(n)%>%
#  kable_styling(position = "center")

stargazer(n,
          header = FALSE,
          title = "Databases",
          digits = 3,
          df = FALSE,
          summary=FALSE,
          rownames = FALSE)

# Total sales from EDIT
total$salesEdit<-total$I3R2C1+total$I3R2C1

#dataframe for Stargazer 
dft2=subset(total, select = c(NORDEMP,sales,valueadded,salesEdit,sales_x,II1R10C2))#sharesales_x,sharesRDi
#Cleaning
dft2<-dft2[!(dft2$sales=="0"|dft2$salesEdit=="0"),]


dft2<-dft2%>%
  mutate(sales=sales/1000)%>%
  mutate(sales_x=sales_x/1000)%>%
  mutate(valueadded=valueadded/1000)%>%
  mutate(sharesales_x=sales_x/sales)%>%
  mutate(sharesRD=II1R10C2/salesEdit)

dft2=subset(dft2, select = -c(salesEdit,sales_x,II1R10C2))

#outliers: NORDEMP=981456,144974,145804,145918 because they have outliers on RDi>0.9
dft2<-dft2[!(dft2$NORDEMP=="981456"|dft2$NORDEMP=="144974"|dft2$NORDEMP=="145804"|dft2$NORDEMP=="145918"),]
dft2=subset(dft2, select = -c(NORDEMP))

#CLEANING outliers
total<-total[!(total$NORDEMP=="981456"|total$NORDEMP=="144974"|total$NORDEMP=="145804"|total$NORDEMP=="145918"),]

colnames(dft2)[1] <- "Total Sales"
colnames(dft2)[2] <- "Value Added"
colnames(dft2)[3] <- "Exports/Sales"
colnames(dft2)[4] <- "RDi/Sales"

stargazer(dft2,
          header = FALSE,
          title = "Descriptive Statistics (2)",
          df = FALSE,
          notes.append=TRUE,
          notes.align = "l",
          notes = c("Note:For the merge between EDIT and EAM,this table shows the descriptive statistics for Total Sales",
                    "Value Added in millions of colombian pesos, value of exported products/Sales and value of investment",
                    "on research, development and innovation (RDi)/Sales.")) 


```

```{r Histogram for Colombia , fig.show='hide', message=FALSE, warning=FALSE, include=FALSE, results='hide'}

# Histogram for Colombia 
my.hist2<-hist(total$Management, ylab ="Probability", breaks=20)

my.hist2$counts
mycount2<-data.frame(my.hist2$counts)
col_freq2 <- prop.table(mycount2)
colnames(col_freq2)[1] <- "Colombia"

#df <- data.frame(, second_column)
my_over_hist2<-data.frame(score_bar,usa_freq,col_freq2)

my_over_hist2$Score<-as.numeric(as.character(unlist(my_over_hist2[[1]])))
my_over_hist2$USA<-as.numeric(as.character(unlist(my_over_hist2[[2]])))
my_over_hist2$Colombia<-as.numeric(as.character(unlist(my_over_hist2[[3]])))


```

According to Bloom(2019) the average U.S Management score (1-16 questions) is 0.615, the non-incentives (1-8) is 0.643 and the incentives (9-16) is 0.583.The following histogram shows the distribution for magement score (16 questions) for Colombia and the United States, using the merge between EDIT and EAM with 6,034 observations. It plots the overlapping histogram of firm management scores for Colombia (2018) and the United States (2010) according to Bloom (2019).  While the Colombian management score (from 1 to 16 questions) was 0.37, for the U.S was 0.61, which implies that the distribution of Colombia is skewed to the left compared to the United States.  

```{r echo=FALSE,warning=(FALSE),message=FALSE,results="asis"}

# Histogram Colombia - USA with merge between EDIT - EAM 
#title = "Management - Colombia vs USA"

library(ggplot2)

ggplot(data=my_over_hist2,aes(x=Score))+
  geom_bar(aes(y=Colombia),stat="identity",position ="identity",alpha=.5,fill='black',color='red') +
  geom_bar(aes(y=USA),stat="identity",position ="identity",alpha=.5,fill='white',color='blue')+ 
  labs(x="Score: Colombia(red) - USA(blue)",
       y="Share")+theme(plot.title = element_text(hjust = 0.5))


write_dta(my_over_hist2,"~/Google Drive/Internship_WB_Summer/Edit/Github/over_hist.dta")

```


## Performance measures

We divide the performance into four groups, a) productivity: production, sales, value added, total factor productivity where we analyze using a production function b) Innovation: investment on research, development and innovation (RDi) and intellectual properties register, which are inputs and outputs for a firm,  c) market competition: management as a dependent variable of external and domestic competition d) trade: exports, imports, number of products sold abroad, destinations, destination product pairs, exports over product destination pairs and exports at top destination-product, where we explore the linkages between management and international trade.


```{r echo=FALSE,warning=(FALSE),message=FALSE,results="asis"}

##############PERFORMANCE BAR GRAPHS##################

#### Mangement and Employment###
#tranformation of employment= A company should have at least 1 employment. Just 3 cases are adjusted, from 0 to 1
total<-total%>%
  mutate(empltot2=ifelse(empltot==0,1,total$empltot))
total$logempltot2<-log(total$empltot2)

#creating the log employment adjusted
total$logempltot2<-log(total$empltot2)


#listing variables to plot (Productivity,Exports, RD and i,Profit,) and some? which?
#1. Productivity (value added/employees)
total$productivity<-total$valueadded/total$empltot2
total$productivity3<-(total$productivity)/1000
#2. Value of Exports: I3R2C2
total$exports_millions<-(total$I3R2C2)/1000
#3. Investement on RD and Innovation: II1R10C2
total$rdi_millions<-(total$II1R10C2)/1000
#4. Operating profit
#a. total wages
total$totalwages<-total$benefits+total$wages
#b. Total expenses
total$totalexpenses<-total$totalwages+total$intinput
#Operating profit
total$opprofit<-total$valprod-total$totalexpenses
total$opprofit_millions<-(total$opprofit)/1000
# 5. intellectual property registers
total$ipr<-total$VI1R8C2
# 6. Wage/Empl - 2018
total$wage_per_emp<-total$totalwages/total$empltot
#7. Ln (Wage/Empl) - 2018
total$lnwage_per_emp<-log(total$wage_per_emp)

max(total$productivity3)

#summary(total$valueadded)

#### Decile graphs######
total$decilmanagement<-ntile(total$Management,10)

bar1<-ggplot(total, aes(x=decilmanagement, y=productivity3))+labs(x="Decile of Management", y="VA/Emp-Mill")+ stat_summary(fun = "mean",geom = "bar")

bar2<-ggplot(total, aes(x=decilmanagement, y=exports_millions))+ 
  labs(x="Decile of Management", y="Av.Exports-Mill") +stat_summary(fun = "mean", geom = "bar")

bar3<-ggplot(total, aes(x=decilmanagement, y=rdi_millions))+ 
  labs(x="Decile of Management", y=" Av.RDi-Mill") +stat_summary(fun = "mean", geom = "bar")
  
bar4<-ggplot(total, aes(x=decilmanagement, y=opprofit_millions))+ 
  labs(x="Decile of Management", y="Av.Profit-Mill") +stat_summary(fun = "mean", geom = "bar")

bar5<-ggplot(total, aes(x=decilmanagement, y=ipr))+ 
  labs(x="Decile of Management", y="Av.IP registers") +stat_summary(fun = "mean", geom = "bar")

bar6<-ggplot(total, aes(x=decilmanagement, y=wage_per_emp))+ 
  labs(x="Decile of Management", y="Av.(Wage/Emp)-Miles") +stat_summary(fun = "mean", geom = "bar")


#install.packages("ggpubr")
library(ggpubr)
ggarrange(bar1, bar2, bar3 , bar4, bar5, bar6+rremove("x.text"),
          ncol = 2, nrow = 3)+theme(plot.title = element_text(hjust = 0.5))



```


We investigate whether management competence is correlated with those measures of performance. We do not attribute a causal interpretation to the results, instead, it replicates the most of regression from Bloom (2019) and Manova (2020), which allows compare coefficients between Colombia and the United States.

## Productivity
 
Suppose that the firm production function is:

$$Y_{i} = A_{i}K_{i}^{\alpha}L_{i}^{\beta}I^{\gamma}e^{\delta M_{i}}e^{\mu X_{i}} + \varepsilon_{i}$$
Where $Y_{i}$:Production of firm i
$A_{i}$: Total factor productivity (Excluding Management Practices)
$K_{i}$:Fixed assets at final of 2018
$L_{i}$:Labor inputs: the total number of employees of firm i
$I_{i}$:Intermediate inputs
$X_{i}$:Vector of additional factors: the percent of staff with college degree
$M_{i}$: Management score (1-16)


Dividing by labor and taking logs we can rewrite this in a form to estimate on the
data:

$$log\frac{Y_{i}}{L_{i}} = \alpha log\frac{K_{i}}{L_{i}} + \gamma log \frac{I_{i}}{L_{i}} + (\alpha+ \beta  +\gamma)log L_{i} +\delta M_{i} + \mu X_{i} + u_{i} $$

We start by running a basic regression of labor productivity (measured as log(output/employee)) on management score, where the first column is calculated with industry fixed effects, the second with location fixed effects and the third without fixed effects. This is repeated for 4 to 6 and 7 to 9 columns, with dependent variable log (sales/employees) and profit/sales, respectively.

## Innovation

The Appendix shows a positive correlation with measures of innovation such as investment on RDi as well as the intellectual property registers. This reflects that management practices keep a strong link with inputs and outputs of innovation, and it serves a good predictor of those variables. 

## Market competition

We specify the possible links between trade liberalization and plant level productivity. Using the firm level measures of TFP, we estimate  the competitive pressure using the China Import Share, where its sign is negative (Appendix).

## Trade

We examine the relationship between firms’ management practices and export performance, testing four propositions:

Proposition 1: Better managed firms are more likely to export.
Proposition 2: Better managed firms export more products to more destination markets and earn
higher export revenues
Proposition 3: The management is more important determinant in heterogeneous industries than homogeneous
Proposition 4: Better management exporters reduce the effect of geographic distance on a gravity equation apprach.

# Data

# Empirical Strategy

# Summary Statistics 

Using the column 1 from Table Firm Management Scores and Performance (1)-Appendix, we find a highly significant coefficient of 0,24, suggesting that whether other variables remain constant, a point increase in our management score from bottom to top group, in other words, from percentile 25 to 75, is associated with a 0.24 * (0.504-0.231): 6.55% increase in labor productivity. 
The Table "Semi-elasticities from bottom to top" shows the changes in exports, products and destinations when increasing the Management Score.


```{r echo=FALSE,warning=(FALSE),message=FALSE,results="asis"}

selasticity<-data.frame(mycol1=c("Output / Emp","Value Added / Emp","Exports - For exporters","Exports - For entire #sample:(1+Exp)","Products - For exporters", "Products- For entire sample:(1+Exp)","Destinations - For exporters","Destinations - For #entire sample:(1+Exp)"),mycol2=c("0.24","0.64", "1.82","4.82","0.94","0.8","0.92","0.76"),mycol3=c("6.55%","17.47%", "49.69%","131.59%","25.66%","21.84%","25.12%","20.75%"))

#install.packages("kableExtra")
#options(kableExtra.latex.load_packages = TRUE)


kable(selasticity, col.names =c("Dependent Variable","Coefficient", "From 25pctl to 75pctl"),booktabs = T,align = 'c',caption = "Semi-elasticities from bottom to top", "latex")


```

# Appendix

```{r echo=FALSE,warning=(FALSE),message=FALSE,results="asis"}

#Reading Expo-Transaction
expocount<-read_csv("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/Export-Transaction/expocount.csv")
colnames(df0)[1]<-"NORDEMP"

df0<-merge(df0,expocount,by="NORDEMP",all.x = TRUE)

#imports of inputs
df0<-merge(df0,total[ ,c("NORDEMP","raw_material_m","intinput","sales","sales_x")], by="NORDEMP",all.x = TRUE)

### exporters###
df0<-df0 %>%
   mutate(Exporters = if_else(sales_x >1, 1,0))

df0<-df0%>%
  mutate(shareinput_m=raw_material_m/intinput)%>%
  mutate(sharesales_x=sales_x/sales)

colnames(df0)[8]<-"Destinations"
colnames(df0)[9]<-"Products"
colnames(df0)[10]<-"Dest-Prod"
colnames(df0)[21]<-"Import/Input"
colnames(df0)[22]<-"Export/Sales"


dft<-subset(df0, select = -c(NORDEMP,export2018_per_dest,intinput,freq,export2018_per_prod,sales,export2018,top_dest_prod,sales_x,export2018_per_dest_prod,raw_material_m))


stargazer(dft,
          header = FALSE,
          title = "Descriptive Statistics",
          digits = 3,
          df = FALSE,
          notes.append=TRUE,
          notes.align = "l",
          notes = c("Note:The management score is the unweighted average of the score for each of the 16 questions, where",                              "each question is first normalized to be on a 0-1 scale. The sample in all columns is allobservations",
                   "with at least 11 non-missing responses to management questions and a successful match to EAM.")) 

```

```{r echo=FALSE,warning=(FALSE),message=FALSE,results="asis"}

##### ggplot#####
#title="Firm size rises with Management -Non-Linear fit"

p <- ggplot(data = total,                # specify dataset
            aes(x = Management, y = logempltot2))+labs(x="Management",y="Log Employment") + # Age on x-, Raven on y-axis
  geom_point(pch = 1,size=0.05)+theme(plot.title = element_text(hjust = 0.5))

q1 <- p +
  geom_smooth() # add scatterplot smoother
q1

```

```{r echo=FALSE,warning=(FALSE),message=FALSE,results="asis",fig.show='hide',results='hide'}

#List of variables for Manegement score and performance FOR ALL REGRESSIONS

#With Logarithms 
#1. Percent of staff_with_college_degree=staff_with_college_degree
total$staff_with_college_degree<-total$IV1R4C2/total$IV1R11C2
#2. Log (production/employees)
total$lnprod<-log(total$valprod/total$empltot)
#2B. Log (sales/employees)
total$lnsales<-log(total$sales/total$empltot)
#3. Log (total employment)=lnempltot
total$lnempltot<-log(total$empltot)
#4. Total Score (1-16)=Management
#5. Log (fixed assets / employees)=lnfape
total$lnfape<-log(total$fixedassets/total$empltot)
#6.Log (intermediate inputs/employees): lniipe
total$lniipe<-log(total$intinput/total$empltot)
##7.Profits/sales=profoversales
total$sales_millions<-total$sales/1000
total$profoversales<-total$opprofit_millions/total$sales_millions
#8.Log (Profit/sales)
total$lnprofoversales<-log(total$profoversales)
#9.Lerner Index
total$lerner<-total$opprofit/total$sales
total$ciiu4_2_d<- substr(total$CIIU4, start = 1, stop = 2)
#10. Ln production
total$lnvalprod<-log(total$valprod)
#11. Ln wages
total$lnwages<-log(total$totalwages)
#12. Ln Fix assets
total$lnfixedassets<-log(total$fixedassets)
#13. Ln Intermediate input
total$lnintinput<-log(total$intinput)
#14. log Intellectual property registers
total$lnipr<-log(1+total$ipr)


#List of variables for Drivers of Productivity variation
#With logarithms 
#0. Log (Value Added/Employees)
total$log_Value_Added_per_Employee<-log(total$valueadded/total$empltot)
#1.Total Score (1-16): total$Management
#2. RDi/emp=II1R10C2/empltot
total$RDi<-total$II1R10C2
total$RDi_per_empl=(total$RDi/total$empltot)
total$RDi_per_empl1=(total$RDi_per_empl)+1
total$lnRDi_per_empl1=log(total$RDi_per_empl1) ####This the variable for RD
#3.Investment on ITC/Emp) - 2018:total$II1R4C2/total$empltot
total$ICT_per_Employee<-total$II1R4C2/total$empltot #### This the variable, since unit are miles, this means spending per 1000 workers



```

```{r echo=FALSE,warning=(FALSE),message=FALSE,results="asis"}

# Plant Management Scores and Performance (1)
#subset1

g1_1<-subset(total,select=c(NORDEMP,lnprod,lnsales,profoversales,Management,lnfape,lniipe,lnempltot,staff_with_college_degree,CIIU4,dpto))
g1_1<-NaRV.omit(g1_1)
g1_2<-subset(total,select=c(NORDEMP,lnsales,Management,lnfape,lniipe,lnempltot,staff_with_college_degree,CIIU4,dpto))
g1_2<-NaRV.omit(g1_2)
g1_3<-subset(total,select=c(NORDEMP,profoversales,Management,lnfape,lniipe,lnempltot,staff_with_college_degree,CIIU4,dpto))
g1_3<-NaRV.omit(g1_3)


m1 <- miceadds::lm.cluster(lnprod ~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree+factor(CIIU4),cluster="NORDEMP", data = g1_1)


#cor(g1_1$lnprod, g1_1$Management): 0.3284096, r2=0.1079
                           
m2 <- miceadds::lm.cluster(lnprod ~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree+factor(dpto),cluster="NORDEMP",data = g1_1)
m3<-miceadds::lm.cluster(lnprod ~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree,cluster="NORDEMP",data=g1_1)

#Log(sales/employees)

m4 <- miceadds::lm.cluster( lnsales~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree+factor(CIIU4),cluster="NORDEMP",data = g1_2)
m5 <- miceadds::lm.cluster(lnsales ~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree+factor(dpto),cluster="NORDEMP",data = g1_2)
m6<-miceadds::lm.cluster(lnsales ~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree,cluster="NORDEMP",data=g1_2)

#Log(profit/employees)

m7 <- miceadds::lm.cluster(profoversales~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree+factor(CIIU4),cluster="NORDEMP",
                      data = g1_3)
m8 <- miceadds::lm.cluster(profoversales ~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree+factor(dpto),cluster="NORDEMP",data = g1_3)
m9<-miceadds::lm.cluster(profoversales ~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree,cluster="NORDEMP",data=g1_3)


texreg(list(m1, m2,m3,m4,m5,m6,m7,m8,m9),caption.above = TRUE, caption="Firm Management Scores and Performance (1)",fontsize = "small", custom.header = list("Ln(Output/Emp)"=1:3,"Ln(Sales/Emp)"=4:6, "Profit/Sales"=7:9),digits =2,omit.coef =c("(Intercept)|(factor)"),custom.coef.names=c("Management","Ln(Cap/Emp)", "Ln(Input/Emp)", "Ln(Employment)","Degree"), custom.model.names =c("1","2","3","4","5","6","7","8","9"),custom.note = ("\\parbox{0.95\\linewidth}{\\vspace{3pt}%stars. \\\\OLS coefficients with standard errors in parentheses (clustered at firm level). The management score is the unweighted average of the score for each of the 16 questions, where each question is first normalized to be on a 0–1 scale. The sample is all EDIT observations with at least 11 non-missing responses to management questions and a successful match to EAM, which have positive value added, positive employment, and positive imputed capital. The columns 1-3 mean the models with Industry Fixed Effects, Location Fixed Effects and no Fixed Effects, respectively.This also applies for columns 4-6 and 7-9. The regressions include clustered standard errors by firm}")) 



```



```{r echo=FALSE,warning=(FALSE),message=FALSE,results="asis"}

# Plant Management Scores and Performance (2)

#subset2
g2_1<-subset(total,select=c(NORDEMP,log_Value_Added_per_Employee,Management,lnfape,lnempltot,staff_with_college_degree,CIIU4,dpto))
g2_1<-NaRV.omit(g2_1)
g2_2<-subset(total,select=c(NORDEMP,lnipr,Management,lnfape,lnempltot,staff_with_college_degree,CIIU4,dpto))
g2_2<-NaRV.omit(g2_2)
g2_3<-subset(total,select=c(NORDEMP,lnRDi_per_empl1,Management,lnfape,lnempltot,staff_with_college_degree,CIIU4,dpto))
g2_3<-NaRV.omit(g2_3)


#FE:yes, with ciiu4. Dependent Variable: Log (Value Added/Employees)


m13 <- miceadds::lm.cluster(log_Value_Added_per_Employee ~ Management + lnfape+lnempltot+staff_with_college_degree+factor(CIIU4),cluster = "NORDEMP", data = g2_1)

m14 <- miceadds::lm.cluster(log_Value_Added_per_Employee ~ Management + lnfape+lnempltot+staff_with_college_degree+factor(dpto), cluster = "NORDEMP",data = g2_1)
#FE:No
m15<-miceadds::lm.cluster(log_Value_Added_per_Employee ~ Management + lnfape+lnempltot+staff_with_college_degree,cluster="NORDEMP", data =g2_1)


#FE:yes, with ciiu4. Dependent Variable:Log(Profits/sales)
m16 <- miceadds::lm.cluster(lnipr ~ Management + lnfape+lnempltot+staff_with_college_degree+factor(CIIU4),cluster = "CIIU4",data = g2_2)

m17 <- miceadds::lm.cluster(lnipr ~ Management + lnfape+lnempltot+staff_with_college_degree+factor(dpto), cluster="dpto",data = g2_2)
#FE:No
m18<-miceadds::lm.cluster(lnipr ~ Management + lnfape+lnempltot+staff_with_college_degree,cluster="NORDEMP",data =g2_2)


#FE:yes, with ciiu4. Dependent Variable:RDi
m19 <- miceadds::lm.cluster(lnRDi_per_empl1~ Management + lnfape+lnempltot+staff_with_college_degree+factor(CIIU4),cluster = "CIIU4", data = g2_3)

#FE:yes, with ciiu4. Dependent Variable:RDi
m20 <- miceadds::lm.cluster(lnRDi_per_empl1~ Management + lnfape+lnempltot+staff_with_college_degree+factor(dpto),cluster = "dpto",data = g2_3)

#FE:No
m21<-miceadds::lm.cluster(lnRDi_per_empl1~ Management + lnfape+lnempltot+staff_with_college_degree,cluster = "NORDEMP",data =g2_3)

texreg(list(m13, m14,m15,m16,m17,m18,m19,m20,m21),caption.above = TRUE, caption="Firm Management Scores and Performance (2)",fontsize = "small",   custom.header = list("Log(VA/Emp)"=1:3,"Log(1+IP Registers)"=4:6, "Log(1+RDi/Emp)"=7:9),digits =2, omit.coef =c("(Intercept)|(factor)"),custom.coef.names=c("Management","Ln(Cap/Emp)","Ln(Employment)","Degree"), custom.model.names =c("1","2","3","4","5","6","7","8","9"),custom.note = ("\\parbox{0.95\\linewidth}{\\vspace{3pt}%stars. \\\\OLS coefficients with standard errors in parentheses. The management score is the unweighted average of the score for each of the 16 questions, where each question is first normalized to be on a 0–1 scale. The sample is all EDIT observations with at least 11 non-missing responses to management questions and a successful match to EAM, which have positive value added, positive employment, and positive imputed capital. The columns 1-3 mean the models with Industry Fixed Effects, Location Fixed Effects and no Fixed Effects, respectively.This also applies for columns 4-6 and 7-9.The regressions include clustered standard errors by firm}")) 


```


```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis"}

# Regression for Drivers of Productivity Variation (dpv)

#IV1R11C2: total personal employed
#II1R10C2:Investment on RDi
#II1R4C2:Investment on ITC

#in order to replace NA by zeroes
g3_subset<-subset(total,select=c(NORDEMP,log_Value_Added_per_Employee,Management,lnRDi_per_empl1,ICT_per_Employee,staff_with_college_degree,CIIU4))


g3_1<-g3_subset
g3_1$lnRDi_per_empl1[is.na(g3_subset$lnRDi_per_empl1)] <- 0
g3_1$ICT_per_Employee[is.na(g3_subset$ICT_per_Employee)] <-256.7
g3_1<-NaRV.omit(g3_1)

reg_dpvlog1<-miceadds::lm.cluster(log_Value_Added_per_Employee ~ Management, cluster="NORDEMP", data =g3_1)
reg_dpvlog2<-miceadds::lm.cluster(log_Value_Added_per_Employee ~ Management+lnRDi_per_empl1,cluster="NORDEMP", data =g3_1)
reg_dpvlog3<-miceadds::lm.cluster(log_Value_Added_per_Employee ~ Management+lnRDi_per_empl1+ICT_per_Employee,cluster="NORDEMP", data =g3_1)
reg_dpvlog4<-miceadds::lm.cluster(log_Value_Added_per_Employee ~ Management+lnRDi_per_empl1+ICT_per_Employee+staff_with_college_degree,cluster="NORDEMP", data =g3_1)


texreg(list(reg_dpvlog1, reg_dpvlog2,reg_dpvlog3,reg_dpvlog4),caption.above = TRUE, caption="Drivers of Productivity Variation",fontsize = "normalsize", custom.header = list("Log(VA/Emp)"=1:4),digits =3,omit.coef =c("(Intercept)|(factor)"),custom.coef.names=c("Management","RDi", "ICT/Emp","Degree"), custom.model.names =c("1","2","3","4"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\OLS coefficients with standard errors in parentheses.Dependent variable is firm level log(Value Added/Employment). Independent variables are Management score, RDi is measured as log(1+RDi intensity), where RDi intensity is the total domestic Research, Development and innovation expenditure in 2018 divided by total domestic employment, ICT/Emp is investment per worker (spending on information and communication technology hardware and software per employee), Degree is measured by the share of employees (managers and non-managers) with a college degree.Missing values have been replaced by zero for RDi and by means for the other variables. The regressions include standard errors clustered by firm}"))

```


```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis", float=FALSE,fig.show='hide',results='hide' }

# TFP and Tariffs (Jozef Konings and Mary Amiti-2005: Trade Liberalization, Intermediate Inputs and Productivity:)

#source: 
#average tariffs: https://www.macmap.org/
# ciiu-product: https://www.dane.gov.co/index.php/sistema-estadistico-nacional-sen/normas-y-estandares/nomenclaturas-y-clasificaciones/tablas-correlativas

tarciiu<- read_csv("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/Tariffs_CIIU4.csv")


avgtarciiu<-data.frame(aggregate( avgtariff ~ CIIU4,tarciiu, mean ))

total <- merge(total,avgtarciiu,by="CIIU4",all=FALSE)

#Subset
g3a<-subset(total,select=c(NORDEMP,lnvalprod,lnwages,lnfixedassets,lnintinput))
g3a<-NaRV.omit(g3a)


mtfp_reg<-lm(lnvalprod ~ lnwages+lnfixedassets+lnintinput,data =g3a)
g3a$p_lnvalprod<-predict(mtfp_reg)

g3a$lna<-g3a$lnvalprod-g3a$p_lnvalprod

#including TFP in Total
total<-merge(total,g3a[ , c("NORDEMP","lna")],by="NORDEMP",all.x =TRUE)

# reading weighted input tariffs
wit<- read_csv("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/weighted_input_tariffs.csv")

total<-merge(total,wit,by="ciiu4_2_d",all.x=TRUE)

total<-total%>%
  relocate(ciiu4_2_d, .before = wit)


#Total Factor Productivity (tfp)
#LogY:lnvalprod
#LogL:lnwages
#LogK:lnfixedassets
#LogI:lnintinput


m41a<-miceadds::lm.cluster(lna~ avgtariff+wit+factor(CIIU4),data=total,cluster = "NORDEMP")


#texreg(list(m41a),caption.above = TRUE, caption="TFP at firm level and Tariffs",fontsize = "normalsize", custom.header #= list("Revenue-based Total Factor Productivity"=1),digits =3,omit.coef ="Intercept",custom.coef.names=c("Average #Output Tariff","Weighted Input Tariff"), custom.model.names =c("1"),custom.note = #("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\OLS coefficients with standard errors in parentheses.Dependent #variable is firm level Total Factor Productivity. According to Konings and Amiti(2005),independent variables are the #Average Output Tariff and Weighted Input Tariff. The Average Tariff is the average of the tariffs according to the CIIU #4 code of the firm, using the data from International Trade Center ITC: macmap.org.Since tariffs are classified HS #codes, we use a table from DANE, which has an equivalence between HS codes and CIIU4, published in: #https://www.dane.gov.co/index.php/sistema-estadistico-nacional-sen/normas-y-estandares/nomenclaturas-y-clasificaciones/#tablas-correlativas, trade section. For the Weighted Input Tariff, we use the imported input -output matrix (IIOM) #published by DANE: https://www.dane.gov.co/index.php/estadisticas-por-tema/cuentas-nacionales/cuentas-nacionales-anuale#s/matrices-complementarias, (2015). Since IOM does not use CIIU4 codes, we elaborate a concordance table between IIOM #activities and two or three digits CIIU4 levels. The average tariff of these two or three digits CIIU4 levels is #weighted by the IIOM and subsequently matched to the firm two or three digits CIIU4 codes. The concordance table is in #the annex. The regressions include clustered standard errors by firm and fixed effects for industry}"))


```


```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis", fig.show='hide',results='hide'}

####Product Market Competition and Management ####

g4<-subset(total,select=c(NORDEMP,Management,lerner))
g4<-NaRV.omit(g4)
g5<-subset(total,select=c(NORDEMP,Management,lna,lerner,lnfape,lnempltot,staff_with_college_degree,CIIU4))
g5<-NaRV.omit(g5)

m22<-lm( Management ~ lerner,data =g4)

#FE industry 4 digits and all controls
m23 <- plm(Management ~ lerner+lnfape+lnempltot+staff_with_college_degree, 
                      index = c("CIIU4"),
                      effect = "individual", 
                      model = "within",
                      data = g5)


rob_se3 <- list(sqrt(diag(vcovHC(m22, type = "HC1"))),
               sqrt(diag(vcovHC(m23, type = "HC1"))))



texreg(list(m22, m23),caption.above = TRUE, caption="Product Market Competition and Management", fontsize = "normalsize", custom.header = list("Management"=1:2),digits =3,override.se = rob_se3,  omit.coef ="Intercept",custom.coef.names=c("Lerner Index","Ln(Cap/Emp)", "Ln(Employment","Degree"), custom.model.names =c("1","2"),custom.note = ("\\parbox{0.6\\linewidth}{\\vspace{3pt}%stars. \\\\The Lerner Index is the gross profits over sales, where gross profits equals to production value less material costs and wage costs in 2018.This table uses this Lerner index without controls:column (1), and with four-digit industry fixed effects and full controls:column (2). The regressions include robust standard errors by four digits CIIU4 codes}"))

```


```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis"}

#Drivers of Total Factor Productivity

g6<-merge(g5,g3_subset[ , c("NORDEMP","lnRDi_per_empl1","ICT_per_Employee","CIIU4")],by="NORDEMP",all.x=TRUE)
g6_b<-NaRV.omit(g6)
g6$lnRDi_per_empl1[is.na(g6$lnRDi_per_empl1)] <- 0
g6$ICT_per_Employee[is.na(g6$ICT_per_Employee)] <-256.7


#Revenue-based Total Factor Productivity

m24<-miceadds::lm.cluster(lna ~ Management+factor(CIIU4.y),cluster="NORDEMP", data=g6,)

m25<-miceadds::lm.cluster(lna ~ Management+lnRDi_per_empl1+factor(CIIU4.y),cluster="NORDEMP", data =g6)

m26<-miceadds::lm.cluster(lna ~ Management+lnRDi_per_empl1+ICT_per_Employee+factor(CIIU4.y),cluster="NORDEMP", data=g6)

m27<-miceadds::lm.cluster(lna ~ Management+lnRDi_per_empl1+ICT_per_Employee+staff_with_college_degree+factor(CIIU4.y),cluster="NORDEMP", data =g6)



texreg(list(m24, m25,m26,m27),caption.above = TRUE, caption="Drivers of Total Factor Productivity", fontsize = "normalsize", custom.header = list("Revenue-based Total Factor Productivity - RTFP"=1:4),digits =3,omit.coef =c("(Intercept)|(factor)"),custom.coef.names=c("Management","RDi", "ICT/Emp","Degree"), custom.model.names =c("1","2","3","4"),custom.note = ("\\parbox{0.9\\linewidth}{\\vspace{3pt}%stars. \\\\OLS coefficients with standard errors in parentheses. Dependent variable is firm level TFP built from industry firm-level. Independent variables are management score, RDi measured as log(1+RDi intensity) where RDi intensity is the total domestic RDi expenditure divided by total domestic employment, IT investment per worker, skill measured by the share of employees (managers and non-managers) with a college
degree.Missing values have been replaced by zero for RDi and by means for the other variables.The regressions include standard errors clusterd by firm and fixed effects for industry}"))


```

```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis", fig.show='hide',results='hide'}

##Market Competition and Management

#average by 2 digits - CIIU4
total$avgtariff_2 <- ave(total$avgtariff, total$ciiu4_2_d)

total<-total%>%
  relocate(avgtariff, .before = wit)

impo_china_ciiu4<-read_dta("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/impo_china_ciiu4.dta")
total <- merge(total,impo_china_ciiu4,by="CIIU4",all.x=TRUE)

total<-total%>%
  relocate( CIIU4,.before = ciiu4_2_d)

#anyNA(total$avgtariff)

g7<-subset(total,select=c(NORDEMP,Management,avgtariff,wit,lnfape,lnempltot,staff_with_college_degree,CIIU4,lerner,chshare,dpto))
g7<-NaRV.omit(g7)


m28<-miceadds::lm.cluster( Management ~ lerner+factor(dpto),data =g7,cluster="CIIU4")
m29 <- miceadds::lm.cluster(Management ~lerner+avgtariff+factor(dpto),data = g7, cluster="CIIU4")
m29a <- miceadds::lm.cluster(Management ~lerner+avgtariff+wit+factor(dpto),data = g7, cluster="CIIU4")
m30<-miceadds::lm.cluster(Management ~lerner+avgtariff+wit+I((lerner*avgtariff))+factor(dpto), cluster="CIIU4",data =g7)
m31<-miceadds::lm.cluster(Management ~lerner+avgtariff+wit+I((lerner*avgtariff))+lnfape+lnempltot+staff_with_college_degree+factor(dpto),cluster="CIIU4",data =g7)

texreg(list(m28, m29,m29a,m30,m31),caption.above = TRUE, caption="Market Competition and Management", fontsize = "normalsize", custom.header = list("Management"=1:5),digits =3,omit.coef =c("(Intercept)|(factor)"),custom.coef.names=c("Lerner Index","Average Output Tariff","Weighted input Tariff", "Inter Lerner*Tariff","Ln(Cap/Emp)", "Ln(Employment)","Degree"), custom.model.names =c("1","2","3","4","5"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\Lerner Index is the gross profits over sales, where gross profits equals to production value less material costs and wage costs in 2018.The Average Tariff is the average of the tariffs according to the CIIU 4 code of the firm, using the data from International Trade Center ITC: macmap.org.Since tariffs are classified HS codes, we use a table from DANE, which has an equivalence between HS codes and CIIU4, published in: https://www.dane.gov.co/index.php/sistema-estadistico-nacional-sen/normas-y-estandares/nomenclaturas-y-clasificaciones/tablas-correlativas, trade section. For the Weighted Input Tariff, we use the imported input -output matrix (IIOM) published by DANE: https://www.dane.gov.co/index.php/estadisticas-por-tema/cuentas-nacionales/cuentas-nacionales-anuales/matrices-complementarias, (2015). Since IOM does not use CIIU4 codes, we elaborate a concordance table between IIOM activities and two or three digits CIIU4 levels. The average tariff of these two or three digits CIIU4 levels is weighted by the IIOM and subsequently matched to the firm two or three digits CIIU4 codes. The concordance table is in the annex. The last column of this regression table includes  a interaction between Lerner Index and Average Output Tariff and full controls. All regressions have Location Fixed Effects by department in Colombia and clustered standard errors by industry.}"))

```

```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis"}


#Chinese imports
m28b<-miceadds::lm.cluster( Management ~ chshare,cluster="CIIU4",data =g7)
m29b <- miceadds::lm.cluster(Management ~chshare+lnfape+lnempltot+staff_with_college_degree,cluster="CIIU4",data = g7)


texreg(list(m28b, m29b),caption.above = TRUE, caption="China Import Share and Management", fontsize = "normalsize", custom.header = list("Management"=1:2),digits =3,omit.coef ="Intercept",custom.coef.names=c("China Import Share","Ln(Cap/Emp)", "Ln(Employment)","Degree"), custom.model.names =c("1","2"),custom.note = ("\\parbox{0.9\\linewidth}{\\vspace{3pt}%stars. \\\\The China Import Share means imports from China / Total imports for each industry (4 digits CIIU rev4). This table uses this China Import Share without controls:column (1), and with full controls:column (2). We estimated the China Import Share according to the Import Origin published by DANE and matched them to the firm four digits CIIU4 codes.The regressions include clustered standard errors by industry (four digits).}"))

```


```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis",fig.show='hide',results='hide' }

#Gravity Equation a country level using World Managemt Survey (do not erase, just hide)
gravity<-read_dta("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/gravity_2013_2015.dta")

gravity2015<-gravity[(gravity$year=="2015"),]
gravity2014<-gravity[(gravity$year=="2014"),]

managementwms<- read_csv("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/managementwms.csv")
gravity2014<-merge(gravity2014,managementwms,by="oNameFull",all.x = TRUE)
gravity2015<-merge(gravity2015,managementwms,by="oNameFull",all.x = TRUE)

gravity2014$lnexp<-log(gravity2014$v)
gravity2014$lngdp_o<-log(gravity2014$gdp_o)
gravity2014$lngdp_d<-log(gravity2014$gdp_d)
gravity2014$lndistw<-log(gravity2014$distw)

gravity2015$lnexp<-log(gravity2015$v)
gravity2015$lngdp_o<-log(gravity2015$gdp_o)
gravity2015$lngdp_d<-log(gravity2015$gdp_d)
gravity2015$lndistw<-log(gravity2015$distw)

#without Management, some controls for all countries
m31a<-lm(lnexp ~lngdp_o+lngdp_d+lndistw+contig+comlang_off,data = gravity2015)

#Management sample
grav_eq<-subset(gravity2015,select=c(year,oNameFull,dNameFull,v,iso_d,iso_o,gdp_o,gdp_d,distw,contig,comlang_off,comcol,colony,col45,comcur, comrelig,lnexp,lngdp_o,lngdp_d,lndistw,managementwms))
grav_eq<-NaRV.omit(grav_eq)

######### without Management, some controls for Management Sample ########
m31b<-lm(lnexp ~lngdp_o+lngdp_d+lndistw+contig+comlang_off,data = grav_eq)


######### with Management, some controls for Management Sample ########
m31c<-miceadds::lm.cluster(lnexp ~lngdp_o+lngdp_d+lndistw+contig+comlang_off+managementwms,cluster= managementwms,data = grav_eq)

texreg(list(m31b, m31c),caption.above = TRUE, caption="Gravity Equation and Management", fontsize = "normalsize", custom.header = list("Ln Exports"=1:2),digits =3,omit.coef ="Intercept",custom.coef.names=c("Ln Exporter's GDP","Ln Importer's GDP", "Ln Distance-km", "Contiguous=1","Common Language=1","Management"), custom.model.names =c("1","2"),custom.note = ("\\parbox{0.9\\linewidth}{\\vspace{3pt}%stars. \\\\This table estimates a gravity model, where the dependent variable is Exporter's GDP, and the independent variables are: Importer's GDP, Distance in kilometers between exporter and importer and the average of Exporter's Management. The sample includes 34 countries in 2015, with data from World Management Survey. The regression calculates clustered standard errors by average Exporter's Management}"))



```


```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis",fig.show='hide',results='hide'}

# Homogeneous and Heterogeneous Products

##Listing variables Trade and Management

#Logarithms
total$lnsales_x<-log(1+total$sales_x)
total$lniraw_m<-log(1+total$raw_material_m)
total$lntrade<-log(1+total$sales_x+total$raw_material_m)

#count(total,"shareraw_m")
#anyNA(total$shareraw_m)

##Shares 
total$sharesales_x<-total$sales_x/total$sales
total$shareraw_m<-total$raw_material_m/total$raw_material
total$sharetrade<-(total$sales_x+total$raw_material_m)/(total$sales+total$raw_material)

#Dummies
#xer: Exporter
#mer: Importer
#traded: Exporter or Importer
total<-total %>%
  mutate(xer = if_else(sales_x >0, 1,0))%>%
  mutate(mer = if_else(raw_material_m >0, 1,0))%>%
  mutate(traded=if_else(sales_x+raw_material_m>0,1,0))


rauch<- read_csv("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/Rauch/cpc_vs_ciiu4_.csv")

rauch_unique<-rauch[!duplicated(rauch$CIIU4), ]

total<-merge(total,rauch_unique,by="CIIU4",all.x = TRUE)
#count(total,"LIBERAL")

total<-total%>%
  mutate(dummy_diff=ifelse(LIBERAL=="n",1,0))

g10<-subset(total,select=c(NORDEMP,lnsales_x,lniraw_m,lntrade,Management,dummy_diff,dpto,lnfape,lnempltot,staff_with_college_degree,CIIU4))
g10<-NaRV.omit(g10)

m31d<-miceadds::lm.cluster(lnsales_x ~Management+I((Management*dummy_diff))+dummy_diff+lnfape+lnempltot+staff_with_college_degree+factor(dpto),cluster="CIIU4",data = g10)


texreg(list(m31d),caption.above = TRUE, caption="Differentiated Products and Management", fontsize = "normalsize",digits =3,custom.coef.names=c("Management","Inter Manag*Diff","Differentiated=1", "Ln(Cap/Emp)","Ln(Employment)","Degree"), custom.model.names =c("Log(1+Exports)"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between logartithm of (1+value of exported products) at firm level and firm's management practices.It includes  a interaction between Management and a Dummy of Differentiated Product:Inter Manag*Diff= 1 when the firm product is differentiated and O otherwise, using Rauch clasiffication. Since Rauch(1999) classifies products at the level of 4 digits of industry, this table assumes that the firm produces only one good, either homogeneous or differentiated, according to its industry(CIIU rev4).In addition, it includes full controls: Ln(Cap/Emp), Ln(Employment) and the percent of staff with college degree. Since Rauch classification used 3 and digit SITC rev.2 levels, we use a concordance table from DANE, which has an equivalence between SITC.rev2 (CPC ver 2.0 in Spanish) and CIIU rev 4, published in: https://www.dane.gov.co/index.php/sistema-estadistico-nacional-sen/normas-y-estandares/nomenclaturas-y-clasificaciones/tablas-correlativas, trade section. The regressions include clustered standard errors by four digits CIIU4 codes}"))


```


```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis", results='hide'}

total$size<-ifelse(total$empltot<=50, 1, ifelse(total$empltot>50 & total$empltot <=250,2, ifelse(total$empltot>250,3,"some value")))

total <- dummy_cols(total, select_columns = 'size')

# dummies TRADE REGRESSIONS (Exports, Imports, Export+Import=Trade. This uses EAM survey data, no expo-transaction) 
g8<-subset(total,select=c(NORDEMP,xer,mer,traded,lnsales_x,lniraw_m,lntrade,Management,dpto,lnfape,lnempltot,lnwage_per_emp,size_3,size_2,staff_with_college_degree,CIIU4))
g8<-NaRV.omit(g8)

#Dummies
m35<-miceadds::lm.cluster(xer ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g8)
m36<-miceadds::lm.cluster(mer ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g8)
m37<-miceadds::lm.cluster(traded ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g8)


texreg(list(m35,m36,m37),caption.above = TRUE, caption="Dummies of trade outcomes and Management", fontsize = "normalsize",digits =3,custom.coef.names=c("Management","Ln(Cap/Emp)","Ln(Employment)","Degree"), custom.model.names =c("Dummy Exports","Dummy Imports","Dummy Trade"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between export status (Dummy Exports = 1 if value of exported products>0 and 0 otherwise), import status (Dummy Import=1 if value of imported inputs>0 and 0 otherwise), trade status (Dummy Trade=1 if value of exports + imports>0 and 0 otherwise) and firm's management practices.It includes some controls: Ln(Cap/Emp), Ln(Employment) and the percent of staff with college degree. All regressions include fixed effects for firm location (department) and 4 digits - CIIU 4 (industry) and clustered standard errors by firm.}"))


```

```{r echo=FALSE, fig.show='hide', message=FALSE, warning=FALSE, results='hide'}

#Trade Outcomes (logs and Shares)
#Logarithms
m32<-miceadds::lm.cluster(lnsales_x ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),data = g8,cluster = "NORDEMP")
m33<-miceadds::lm.cluster(lniraw_m ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g8)
m34<-miceadds::lm.cluster(lntrade ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g8)

texreg(list(m32, m33,m34),caption.above = TRUE, caption="Logarithms of trade outcomes and Management", fontsize = "normalsize",digits =3,custom.coef.names=c("Management","Ln(Cap/Emp)","Ln(Employment)","Degree"), custom.model.names =c("Log(1+Exports)","Log(1+Imports)","Log(1+Exports+Imports)"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{0.8\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between logartithm of (1+value of exported products), logarithm of (1+value of imported inputs) and logarithm of (1+value of exported products + imported inputs) at firm level and firm's management practices.It includes some controls: Ln(Cap/Emp), Ln(Employment) and the percent of staff with college degree. All regressions include fixed effects for firm location (department) and 4 digits - CIIU 4 (industry) and clustered standard errors by firm.}"))

#Share REGRESSION
g9<-subset(total,select=c(NORDEMP,sharesales_x,shareraw_m,sharetrade,Management,dpto,lnfape,lnempltot,staff_with_college_degree,CIIU4))
g9<-NaRV.omit(g9)

m38<-miceadds::lm.cluster(sharesales_x ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g9)
m39<-miceadds::lm.cluster(shareraw_m ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g9)
m40<-miceadds::lm.cluster(sharetrade ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g9)

texreg(list(m38,m39,m40),caption.above = TRUE, caption="Shares of trade outcomes and Management", fontsize = "normalsize",digits =3,custom.coef.names=c("Management","Ln(Cap/Emp)","Ln(Employment)","Degree"), custom.model.names =c("Share of exported products","Share of imported inputs","Share of traded"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between Share of exported products = exports/total sales, Share of imported inputs=imports/total inputs, Share of traded=(exports+imports)/(total sales + inputs) and firm's management practices.It includes some controls: Ln(Cap/Emp), Ln(Employment) and the percent of staff with college degree. All regressions include fixed effects for firm location (department) and 4 digits - CIIU 4 (industry) and clustered standard errors by firm.}"))

```

```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis",fig.show='hide',results='hide'}

#Expo-transaction, hidden because it is replaced for more specific tables - DO NOT ERASE

expotran<- read_csv("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/Export-Transaction/lnexpocount.csv")

total<-merge(total,expotran,by="NORDEMP",all.x = TRUE)

g11<-subset(total,select=c(NORDEMP,lncount_destiny,lncount_products,lncount_dest_prod,lnexport2018,lnexport2018_per_dest,lnexport2018_per_prod,lnexport2018_per_dest_prod,lntop_dest_prod,Management,dpto,lnfape,lnempltot,staff_with_college_degree,lnwage_per_emp,CIIU4))
g11<-NaRV.omit(g11)

m42<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)

m43<-miceadds::lm.cluster(lncount_products ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)

m44<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)

m45<-miceadds::lm.cluster(lnexport2018_per_dest_prod ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)

m46<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)


texreg(list(m42,m43,m44,m45,m46),caption.above = TRUE, caption="Extensive and Intensive Margins of Exports", fontsize = "normalsize",digits =3,custom.coef.names=c("Management","Ln(Cap/Emp)","Ln(Empl)","Degree"), custom.model.names =c("Log Dest","Log Prod","Log DestProd", "Log Exp/DestProd", "Log Exp TopDestProd"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports. The regressions have fixed effects by four digits CIIU4 and Location. Standard errors clustered by firm.}"))

```

```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis",fig.show='hide',results='hide'}

#Expo-transaction 1
#Without employment without fixed effects, with clustered SE by firm
m47<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m48<-miceadds::lm.cluster(lncount_products ~Management+lnfape+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m49<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m49a<-miceadds::lm.cluster(lnexport2018~Management+lnfape+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m50<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m51<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m52<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m53<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)

#WithOUT employment with fixed effects, with clustered SE by firm
m54<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m55<-miceadds::lm.cluster(lncount_products ~Management+lnfape+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m56<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m56a<-miceadds::lm.cluster(lnexport2018 ~Management+lnfape+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m57<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m58<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m59<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m60<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)

texreg(list(m47,m48,m49,m49a,m50,m51,m52,m53),caption.above = TRUE, caption="Extensive and Intensive Margins - No employment and No fixed effects", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Degree","Ln(Wage/Emp)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports. LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product).The regressions have standard errors clustered by firm.}"))

texreg(list(m54,m55,m56,m56a,m57,m58,m59,m60),caption.above = TRUE, caption="Extensive and Intensive Margins - No Employment and Fixed Effects, ", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Degree","Ln(Wage/Emp)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports.LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product).The regressions have fixed effects by four digits CIIU4 and location and standard errors clustered by firm.}"))

```

```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis",fig.show='hide',results='hide'}

###Expo-transaction 2
# employment, no fixed effects, with clustered SE by firm
m61<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m62<-miceadds::lm.cluster(lncount_products ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m63<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m63a<-miceadds::lm.cluster(lnexport2018 ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m64<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m65<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m66<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m67<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)

#With employment with fixed effects, with clustered SE by firm
m68<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp++factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m69<-miceadds::lm.cluster(lncount_products ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m70<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m70a<-miceadds::lm.cluster(lnexport2018 ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m71<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m72<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m73<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m74<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)


texreg(list(m61,m62,m63,m63a,m64,m65,m66,m67),caption.above = TRUE, caption="Extensive and Intensive Margins - With employment, No fixed effects", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Ln(Empl)","Degree","Ln(Wage/Emp)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1.1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports. LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product). The regressions include employment as a control and have standard errors clustered by firm.}"))

texreg(list(m68,m69,m70,m70a,m71,m72,m73,m74),caption.above = TRUE, caption="Extensive and Intensive Margins - With Employment and Fixed Effects and ", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Ln(Empl)","Degree","Ln(Wage/Emp)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports. LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product).The regressions have standard errors clustered by firm.}"))


```

```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis",fig.show='hide',results='hide'}




g12<-subset(total,select=c(NORDEMP,lncount_destiny,lncount_products,lncount_dest_prod,lnexport2018,lnexport2018_per_dest,lnexport2018_per_prod,lnexport2018_per_dest_prod,lntop_dest_prod,Management,dpto,lnfape,lnempltot,staff_with_college_degree,CIIU4,lnfape,size_3,size_2,lnwage_per_emp))
g12<-NaRV.omit(g12)

# employment, no fixed effects, with clustered SE by firm
m75<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g12)
m76<-miceadds::lm.cluster(lncount_products ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g12)
m77<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g12)
m77a<-miceadds::lm.cluster(lnexport2018~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g12)
m78<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g12)
m79<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g12)
m80<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g12)
m81<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g12)

texreg(list(m75,m76,m77,m77a,m78,m79,m80,m81),caption.above = TRUE, caption="Extensive and Intensive Margins - With employment Dummies, No fixed effects", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Big=1","Medium=1","Degree","Ln(Wage/Emp)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1.1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firm's management practices and the extensive and intensive margins of their exports. LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product).The regressions include dummies employment as a control, where 50<medium<250 workers,big>250 and small<50 is excluded by collinearity .It also has standard errors clustered by firm.}"))


```

```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis"}

### EXPO-TRANSACTION (Final Table)
#With employment dummies with fixed effects, with clustered SE by firm
m82<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12)
m83<-miceadds::lm.cluster(lncount_products ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12)
m84<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12)
m84a<-miceadds::lm.cluster(lnexport2018 ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12)
m85<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12)
m86<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12)
m87<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12)
m88<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12)

#merge with whole (original) expo-transaction data at levels 
total<-merge(total,expocount,by="NORDEMP",all.x = TRUE)

g12a<-subset(total,select=c(NORDEMP,count_destiny,count_products,count_dest_prod,export2018,export2018_per_dest,export2018_per_prod,export2018_per_dest_prod,top_dest_prod,Management,dpto,lnfape,lnempltot,staff_with_college_degree,CIIU4,lnfape,size_3,size_2,lnwage_per_emp,dummy_diff))

g12a[is.na(g12a)] <- 0

g12a<-g12a%>%
  mutate(ln_1_count_destiny=log(1+count_destiny))%>%
  mutate(ln_1_count_products=log(1+count_products))%>%
  mutate(ln_1_count_dest_prod=log(1+count_dest_prod))%>%
  mutate(ln_1_export2018=log(1+export2018))%>%
  mutate(ln_1_export2018_per_dest=log(1+export2018_per_dest))%>%
  mutate(ln_1_export2018_per_prod=log(1+export2018_per_prod))%>%
  mutate(ln_1_export2018_per_dest_prod=log(1+export2018_per_dest_prod))%>%
  mutate(ln_1_top_dest_prod=log(1+top_dest_prod))

g12a<-NaRV.omit(g12a)

#count(g12a,"NORDEMP")

#With employment dummies with fixed effects, with clustered SE by firm USING Log (1+variable)
m82_all<-miceadds::lm.cluster(ln_1_count_destiny ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a)
m83_all<-miceadds::lm.cluster(ln_1_count_products ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a)
m84_all<-miceadds::lm.cluster(ln_1_count_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a)
m84a_all<-miceadds::lm.cluster(ln_1_export2018 ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a)
m85_all<-miceadds::lm.cluster(ln_1_export2018_per_dest~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a)
m86_all<-miceadds::lm.cluster(ln_1_export2018_per_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a)
m87_all<-miceadds::lm.cluster(ln_1_export2018_per_dest_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a)
m88_all<-miceadds::lm.cluster(ln_1_top_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a)

##1 trade dummies with size dummies and wage_per_empl 
#########Table 5 (Dummies)######

#Dummies
m35b<-miceadds::lm.cluster(xer ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g8)
m36b<-miceadds::lm.cluster(mer ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g8)
m37b<-miceadds::lm.cluster(traded ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g8)

texreg(list(m35b,m36b,m37b),caption.above = TRUE, caption="Dummies of trade outcomes and Management", fontsize = "normalsize",digits =3,custom.coef.names=c("Management","Ln(Cap/Emp)","Big=1","Medium=1","Degree","Ln(Wage/Emp)"), custom.model.names =c("Dummy Exports","Dummy Imports","Dummy Trade"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between export status (Dummy Exports = 1 if value of exported products>0 and 0 otherwise), import status (Dummy Import=1 if value of imported inputs>0 and 0 otherwise), trade status (Dummy Trade=1 if value of exports + imports>0 and 0 otherwise) and firm's management practices.It includes some controls: Ln(Cap/Emp), Ln(Employment) and the percent of staff with college degree. All regressions include fixed effects for firm location (department) and 4 digits - CIIU 4 (industry) and clustered standard errors by firm }"))


################################


texreg(list(m82,m83,m84,m84a,m85,m86,m87,m88),caption.above = TRUE, caption="Extensive and Intensive Margins for Exporters - With Employment Dummies and Fixed Effects", fontsize = "small",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Big=1","Medium=1","Degree","Ln(Wage/Emp)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports. LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product).The regressions include dummies employment as a control, where 50<medium<250 workers,big>250 and small<50 is excluded by collinearity. It also has standard errors clustered by firm and fixed effects for industry and region}"))


texreg(list(m82_all,m83_all,m84_all,m84a_all,m85_all,m86_all,m87_all,m88_all),caption.above = TRUE, caption="Extensive and Intensive Margins for all firms - With Employment Dummies and Fixed Effects", fontsize = "small",digits =2,custom.coef.names=c("Manag","Ln(C/E)","Big=1","Med=1","Degree","Ln(W/E)"), custom.model.names =c("Ln(1+D)","Ln(1+P)","Ln(1+DP)","Ln(1+E)", "Ln(1+E/D)","Ln(1+E/P)", "Ln(1+E/D-P)", "Ln(1+TopDP)"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins for the entire sample applying the transformation (1 + variable). D:destinations,P:products by HS 6 digits,DP:pairs destination-products,E:Exports,E/D:Exports/Destinations,E/P:Exports/Products,E/D-P:Exports/pairs destination-products,TopD-P:exports in a firm's highest-revenue destination-product.The regressions include dummies employment as a control, where 50<medium<250 workers,big>250 and small<50 is excluded by collinearity. It also has standard errors clustered by firm and fixed effects for industry and region.}"))


```


```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis",fig.show='hide',results='hide'}

####FE and Employment Dummies for homogeneous and heterogeneous, discarded as not relevant


# For Homogeneous: Dummy_diff=0

g13<-subset(total,select=c(NORDEMP,lncount_destiny,lncount_products,lncount_dest_prod,lnexport2018,lnexport2018_per_dest,lnexport2018_per_prod,lnexport2018_per_dest_prod,lntop_dest_prod,Management,dpto,lnfape,lnempltot,staff_with_college_degree,CIIU4,lnfape,size_3,size_2,lnwage_per_emp,dummy_diff))

g13<-g13[!(g13$dummy_diff=="1"),]
g13<-NaRV.omit(g13)


#With employment with fixed effects, with clustered SE by firm
m89<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13)
m90<-miceadds::lm.cluster(lncount_products ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13)
m91<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13)
m92<-miceadds::lm.cluster(lnexport2018 ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13)
m93<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13)
m94<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13)
m95<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13)
m96<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13)


# For Heterogeneous: dummy_diff=1
g14<-subset(total,select=c(NORDEMP,lncount_destiny,lncount_products,lncount_dest_prod,lnexport2018,lnexport2018_per_dest,lnexport2018_per_prod,lnexport2018_per_dest_prod,lntop_dest_prod,Management,dpto,lnfape,lnempltot,staff_with_college_degree,CIIU4,lnfape,size_3,size_2,lnwage_per_emp,dummy_diff))
g14<-g14[!(g14$dummy_diff=="0"),]
g14<-NaRV.omit(g14)

#With employment with fixed effects, with clustered SE by firm
m97<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g14)
m98<-miceadds::lm.cluster(lncount_products ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g14)
m99<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g14)
m100<-miceadds::lm.cluster(lnexport2018 ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g14)
m101<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g14)
m102<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g14)
m103<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g14)
m104<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g14)


texreg(list(m89,m90,m91,m92,m93,m94,m95,m96),caption.above = TRUE, caption="Extensive and Intensive Margins for HOMOGENEOUS PRODUCTS - With Employment Dummies and Fixed Effects", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Big=1","Medium=1","Degree","Ln(Wage/Emp)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports, filtering data for homogeneous products according to classification by Rauch (1999) LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product).The regressions include dummies employment as a control, where 50<medium<250 workers,big>250 and small<50 is excluded by collinearity. It also has standard errors clustered by firm.}"))


texreg(list(m97,m98,m99,m100,m101,m102,m103,m104),caption.above = TRUE, caption="Extensive and Intensive Margins for DIFFERENTIATED PRODUCTS - With Employment Dummies and Fixed Effects", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Big=1","Medium=1","Degree","Ln(Wage/Emp)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports, filtering data for differentiated products according to classification by Rauch (1999). LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product).The regressions include dummies employment as a control, where 50<medium<250 workers,big>250 and small<50 is excluded by collinearity. It also has standard errors clustered by firm.}"))



```

```{r echo=FALSE, fig.show='hide', message=FALSE, warning=FALSE, results='hide'}

# ALL FIRMS for homogeneous and Heterogeneous, using Ln(1+Exp),discarded as not relevant

#Subset with log(1+expo-transaction variable), filtering for homogeneous products
g12a_hom<-g12a[!(g12a$dummy_diff=="1"),]


#With employment with fixed effects, with clustered SE by firm
m89_all<-miceadds::lm.cluster(ln_1_count_destiny ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a_hom)
m90_all<-miceadds::lm.cluster(ln_1_count_products ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a_hom)
m91_all<-miceadds::lm.cluster(ln_1_count_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a_hom)
m92_all<-miceadds::lm.cluster(ln_1_export2018 ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a_hom)
m93_all<-miceadds::lm.cluster(ln_1_export2018_per_dest~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a_hom)
m94_all<-miceadds::lm.cluster(ln_1_export2018_per_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a_hom)
m95_all<-miceadds::lm.cluster(ln_1_export2018_per_dest_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a_hom)
m96_all<-miceadds::lm.cluster(ln_1_top_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a_hom)

#Filtering for differentiated products
g12a_diff<-g12a[(g12a$dummy_diff=="1"),]

#With employment with fixed effects, with clustered SE by firm
m97_all<-miceadds::lm.cluster(ln_1_count_destiny ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a_diff)
m98_all<-miceadds::lm.cluster(ln_1_count_products ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a_diff)
m99_all<-miceadds::lm.cluster(ln_1_count_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a_diff)
m100_all<-miceadds::lm.cluster(ln_1_export2018 ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a_diff)
m101_all<-miceadds::lm.cluster(ln_1_export2018_per_dest~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a_diff)
m102_all<-miceadds::lm.cluster(ln_1_export2018_per_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a_diff)
m103_all<-miceadds::lm.cluster(ln_1_export2018_per_dest_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a_diff)
m104_all<-miceadds::lm.cluster(ln_1_top_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a_diff)


texreg(list(m89_all,m90_all,m91_all,m92_all,m93_all,m94_all,m95_all,m96_all),caption.above = TRUE, caption="Extensive and Intensive Margins for HOMOGENEOUS PRODUCTS - With Employment Dummies and Fixed Effects", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Big=1","Medium=1","Degree","Ln(Wage/Emp)"), custom.model.names =c("Ln(1+D)","Ln(1+P)","Ln(1+D-P)","Ln(1+Exp)", "Ln(1+Exp/D)","Ln(1+Exp/P)", "Ln(1+Exp/D-P)", "Ln(1+TopD-P)"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports, filtering data for homogeneous products according to classification by Rauch (1999) D:destinations,P:products by HS 6 digits,D-P:pairs destination-products,Exp:Exports, Exp/D: Exports/Destinations,Exp/P:Exports/Products, Exp/D-P:Exports/pairs destination-products,TopD-P:exports in a firm's highest-revenue destination-product.The regressions include dummies employment as a control, where 50<medium<250 workers,big>250 and small<50 is excluded by collinearity. It also has standard errors clustered by firm.}"))


texreg(list(m97_all,m98_all,m99_all,m100_all,m101_all,m102_all,m103_all,m104_all),caption.above = TRUE, caption="Extensive and Intensive Margins for DIFFERENTIATED PRODUCTS - With Employment Dummies and Fixed Effects", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Big=1","Medium=1","Degree","Ln(Wage/Emp)"), custom.model.names =c("Ln(1+D)","Ln(1+P)","Ln(1+D-P)","Ln(1+Exp)", "Ln(1+Exp/D)","Ln(1+Exp/P)", "Ln(1+Exp/D-P)", "Ln(1+TopD-P)"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports, filtering data for differentiated products according to classification by Rauch (1999).D:destinations,P:products by HS 6 digits,D-P:pairs destination-products,Exp:Exports, Exp/D: Exports/Destinations,Exp/P:Exports/Products, Exp/D-P:Exports/pairs destination-products,TopD-P:exports in a firm's highest-revenue destination-product.The regressions include dummies employment as a control, where 50<medium<250 workers,big>250 and small<50 is excluded by collinearity. It also has standard errors clustered by firm.}"))


```

```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis"}

#Extensive and Intensive Margins for all firms BY COMPLEXITY

#importing product-complexity from Harvard data
prodcomplex2018<- read_csv("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/Product_Complexity/prodcomplex2018.csv")
#importing whole expo-transaction data 
dataexpotran<- read_csv("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/Export-Transaction/dataexpotransactionoriginal.csv")

countries_ocde<- c("Alemania", "Australia", "Austria", "Bélgica", "Canadá","Corea,Dinamarca","Eslovenia", "España", "Estados Unidos","Estonia", "Finlandia", "Francia", "Grecia", "Hungría", "Irlanda", "Islandia", "Israel","Italia", "Japón", "Letonia", "Lituania", "Luxemburgo", "México", "Noruega", "Nueva Zelandia","Países Bajos", "Polonia", "Portugal", "Reino Unido", "República Checa", "Suecia", "Suiza", "Turquía")

contiguous<-c("Venezuela", "Panamá", "Brasil","Ecuador", "Perú")

spanish<-c("Mexico","España","Argentina","Perú","Venezuela","Chile","Guatemala","Ecuador","Cuba","Bolivia","República Dominicana","Honduras","El Salvador","Paraguay","Nicaragua","Costa Rica","Panamá","Puerto Rico","Uruguay")


dataexpotran$ocde <- ifelse(dataexpotran$country %in% countries_ocde, 1,0)
dataexpotran$not_contiguous <- ifelse(dataexpotran$country %in% contiguous, 0,1)
dataexpotran$not_spanish <- ifelse(dataexpotran$country %in% spanish, 0,1)

dataexpotran$hs4<-substr(dataexpotran$hs6digits, 1, 4)
prodcomplex2018<-merge(prodcomplex2018,dataexpotran,by="hs4",all.x = TRUE)

pivotprodcomplex2018_complex<-aggregate(list(prodcomplex2018$complex), by=list(prodcomplex2018$NORDEMP),FUN=mean,na.rm=TRUE)
pivotprodcomplex2018_ocde<-aggregate(list(prodcomplex2018$ocde), by=list(prodcomplex2018$NORDEMP),FUN=sum,na.rm=TRUE)
pivotprodcomplex2018_not_cont<-aggregate(list(prodcomplex2018$not_contiguous), by=list(prodcomplex2018$NORDEMP),FUN=sum,na.rm=TRUE)
pivotprodcomplex2018_not_span<-aggregate(list(prodcomplex2018$not_spanish), by=list(prodcomplex2018$NORDEMP),FUN=sum,na.rm=TRUE)

colnames(pivotprodcomplex2018_complex)[1] <- "NORDEMP"
colnames(pivotprodcomplex2018_complex)[2] <- "meancomplex"
colnames(pivotprodcomplex2018_ocde)[1] <- "NORDEMP"
colnames(pivotprodcomplex2018_ocde)[2] <- "ocde"
colnames(pivotprodcomplex2018_not_cont)[1] <- "NORDEMP"
colnames(pivotprodcomplex2018_not_cont)[2] <- "not_cont"
colnames(pivotprodcomplex2018_not_span)[1] <- "NORDEMP"
colnames(pivotprodcomplex2018_not_span)[2] <- "not_span"

pivotprodcomplex2018<-merge(pivotprodcomplex2018_complex,pivotprodcomplex2018_ocde,by = "NORDEMP", all.x = TRUE)
pivotprodcomplex2018<-merge(pivotprodcomplex2018,pivotprodcomplex2018_not_cont,by = "NORDEMP", all.x = TRUE)
pivotprodcomplex2018<-merge(pivotprodcomplex2018,pivotprodcomplex2018_not_span,by = "NORDEMP", all.x = TRUE)


pivotprodcomplex2018$ocde <-ifelse(pivotprodcomplex2018$ocde>0, 1,0)
pivotprodcomplex2018$not_cont <-ifelse(pivotprodcomplex2018$not_cont>0, 1,0)
pivotprodcomplex2018$not_span <-ifelse(pivotprodcomplex2018$not_span>0, 1,0)


total<-merge(total,pivotprodcomplex2018,by="NORDEMP",all.x = TRUE)

g13_comp<-subset(total,select=c(NORDEMP,lncount_destiny,lncount_products,lncount_dest_prod,lnexport2018,lnexport2018_per_dest,lnexport2018_per_prod,lnexport2018_per_dest_prod,lntop_dest_prod,Management,dpto,lnfape,lnempltot,staff_with_college_degree,CIIU4,lnfape,size_3,size_2,lnwage_per_emp,meancomplex,ocde,not_cont,not_span))
g13_comp<-NaRV.omit(g13_comp)

#median(g13_comp$meancomplex):0.2285

g13_comp<-g13_comp%>%
  mutate(complexindicator=ifelse(meancomplex>0.2285,1,0))
#Filtering for NO complex(lower than median)

# For NON-COMPLEX: complexidicator=="0"
g13_comp_0<-g13_comp[(g13_comp$complexindicator=="0"),]

#With employment with fixed effects, with clustered SE by firm
m89_comp<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp_0)
m90_comp<-miceadds::lm.cluster(lncount_products ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp_0)
m91_comp<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp_0)
m92_comp<-miceadds::lm.cluster(lnexport2018 ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp_0)
m93_comp<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp_0)
m94_comp<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp_0)
m95_comp<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp_0)
m96_comp<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp_0)


# For COMPLEX: complexidicator=="1"
g13_comp_1<-g13_comp[(g13_comp$complexindicator=="1"),]

#With employment with fixed effects, with clustered SE by firm
m97_comp<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp_1)
m98_comp<-miceadds::lm.cluster(lncount_products ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp_1)
m99_comp<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp_1)
m100_comp<-miceadds::lm.cluster(lnexport2018 ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp_1)
m101_comp<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp_1)
m102_comp<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp_1)
m103_comp<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp_1)
m104_comp<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp_1)

##2 note with fixed effects for region and industry

texreg(list(m89_comp,m90_comp,m91_comp,m92_comp,m93_comp,m94_comp,m95_comp,m96_comp),caption.above = TRUE, caption="Extensive and Intensive Margins for Non-Complex Products", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Big=1","Medium=1","Degree","Ln(Wage/Emp)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports, filtering data for complex products according to product complexity ranking from Atlas of Economic Complexity. This table uses a sub-sample, where the products have a complexity index lower than its median of the entire sample. The complex index is calculated at HS 4digits and matched with the firm's products. LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product).The regressions include dummies employment as a control, where 50<medium<250 workers,big>250 and small<50 is excluded by collinearity. It also has standard errors clustered by firm and fixed effects for industry and region.}"))


texreg(list(m97_comp,m98_comp,m99_comp,m100_comp,m101_comp,m102_comp,m103_comp,m104_comp),caption.above = TRUE, caption="Extensive and Intensive Margins for Complex Products", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Big=1","Medium=1","Degree","Ln(Wage/Emp)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports, filtering data for complex products according to product complexity ranking from Atlas of Economic Complexity. This table uses a sub-sample, where the products have a product complexity index greater than its median of the entire sample . he complex index is calculated at HS 4digits and matched with the firm's products. LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product).The regressions include dummies employment as a control, where 50<medium<250 workers,big>250 and small<50 is excluded by collinearity. It also has standard errors clustered by firm and fixed effects for industry and region.}"))


```




```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis"}

##3 for exporters 
# Interaction (_I) between Management and Complexity and #With employment with fixed effects, with clustered SE by firm

m89_comp_I<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ I((Management*meancomplex))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m90_comp_I<-miceadds::lm.cluster(lncount_products ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ I((Management*meancomplex))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m91_comp_I<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ I((Management*meancomplex))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m92_comp_I<-miceadds::lm.cluster(lnexport2018 ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ I((Management*meancomplex))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m93_comp_I<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ I((Management*meancomplex))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m94_comp_I<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ I((Management*meancomplex))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m95_comp_I<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ I((Management*meancomplex))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m96_comp_I<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ I((Management*meancomplex))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)


texreg(list(m89_comp_I,m90_comp_I,m91_comp_I,m92_comp_I,m93_comp_I,m94_comp_I,m95_comp_I,m96_comp_I),caption.above = TRUE, caption="Extensive and Intensive Margins with Management and Complexity Interaction - Exporters", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Big=1","Medium=1","Degree","Ln(Wage/Emp)", "I(Man*Compl)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports, filtering data for complex products according to product complexity ranking from Atlas of Economic Complexity. This table uses a sub-sample, where the products have a complexity index lower than its median of the entire sample. The complex index is calculated at HS 4digits and matched with the firm's products. LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product).The regressions include dummies employment as a control, where 50<medium<250 workers,big>250 and small<50 is excluded by collinearity. It also has standard errors clustered by firm and fixed effects for industry and region.}"))


```


```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis"}

##3 for all firms (1+Exp)
######Interaction I(Management and Complexity) for whole sample (1+Exp)

g12a<-merge(g12a,g13_comp[,c("NORDEMP","meancomplex")],by="NORDEMP",all.x = TRUE)


#With employment dummies with fixed effects, with clustered SE by firm USING Log (1+variable)
m82_all_I<-miceadds::lm.cluster(ln_1_count_destiny ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ I((Management*meancomplex))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a)
m83_all_I<-miceadds::lm.cluster(ln_1_count_products ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ I((Management*meancomplex))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a)
m84_all_I<-miceadds::lm.cluster(ln_1_count_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ I((Management*meancomplex))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a)
m84a_all_I<-miceadds::lm.cluster(ln_1_export2018 ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ I((Management*meancomplex))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a)
m85_all_I<-miceadds::lm.cluster(ln_1_export2018_per_dest~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ I((Management*meancomplex))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a)
m86_all_I<-miceadds::lm.cluster(ln_1_export2018_per_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ I((Management*meancomplex))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a)
m87_all_I<-miceadds::lm.cluster(ln_1_export2018_per_dest_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ I((Management*meancomplex))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a)
m88_all_I<-miceadds::lm.cluster(ln_1_top_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ I((Management*meancomplex))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12a)

texreg(list(m82_all_I,m83_all_I,m84_all_I,m84a_all_I,m85_all_I,m86_all_I,m87_all_I,m88_all_I),caption.above = TRUE, caption="Extensive and Intensive Margins with Management and Complexity Interaction - all firms", fontsize = "small",digits =2,custom.coef.names=c("Manag","Ln(C/E)","Big=1","Med=1","Degree","Ln(W/E)","I(Man*Compl)"), custom.model.names =c("Ln(1+D)","Ln(1+P)","Ln(1+DP)","Ln(1+E)", "Ln(1+E/D)","Ln(1+E/P)", "Ln(1+E/D-P)", "Ln(1+TopDP)"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins for the entire sample applying the transformation (1 + variable). D:destinations,P:products by HS 6 digits,DP:pairs destination-products,E:Exports,E/D:Exports/Destinations,E/P:Exports/Products,E/D-P:Exports/pairs destination-products,TopD-P:exports in a firm's highest-revenue destination-product.The regressions include dummies employment as a control, where 50<medium<250 workers,big>250 and small<50 is excluded by collinearity. It also has standard errors clustered by firm and fixed effects for industry and region.}"))


```

```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis"}

##5 For Exporters ADDING dummies (Ocde=1, not contiguous=1, not spnahish=1)

#1
m89_comp_D_1<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ocde+ I((Management*ocde))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m90_comp_D_1<-miceadds::lm.cluster(lncount_products ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ocde+ I((Management*ocde))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m91_comp_D_1<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp +ocde+ I((Management*ocde))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m92_comp_D_1<-miceadds::lm.cluster(lnexport2018 ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ocde+ I((Management*ocde))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m93_comp_D_1<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ocde+ I((Management*ocde))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m94_comp_D_1<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ocde+ I((Management*ocde))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m95_comp_D_1<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ocde+ I((Management*ocde))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m96_comp_D_1<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ocde+ I((Management*ocde))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)

#2
m89_comp_D_2<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+not_cont+I((Management*not_cont))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m90_comp_D_2<-miceadds::lm.cluster(lncount_products ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ not_cont+I((Management*not_cont))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m91_comp_D_2<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp +not_cont+I((Management*not_cont))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m92_comp_D_2<-miceadds::lm.cluster(lnexport2018 ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ not_cont+I((Management*not_cont))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m93_comp_D_2<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+ not_cont+I((Management*not_cont))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m94_comp_D_2<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+not_cont+I((Management*not_cont))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m95_comp_D_2<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+not_cont+I((Management*not_cont))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m96_comp_D_2<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+not_cont+I((Management*not_cont))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)

#3
m89_comp_D_3<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+not_span+ I((Management*not_span))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m90_comp_D_3<-miceadds::lm.cluster(lncount_products ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+not_span+ I((Management*not_span))+I((Management*not_span))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m91_comp_D_3<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp +not_span+ I((Management*not_span))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m92_comp_D_3<-miceadds::lm.cluster(lnexport2018 ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp++not_span+ I((Management*not_span))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m93_comp_D_3<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+not_span+ I((Management*not_span))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m94_comp_D_3<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+not_span+ I((Management*not_span))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m95_comp_D_3<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp++not_span+ I((Management*not_span))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)
m96_comp_D_3<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp++not_span+ I((Management*not_span))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g13_comp)


#Oecd
texreg(list(m89_comp_D_1,m90_comp_D_1,m91_comp_D_1,m92_comp_D_1,m93_comp_D_1,m94_comp_D_1,m95_comp_D_1,m96_comp_D_1),caption.above = TRUE, caption="Extensive and Intensive Margins with Management and Complexity Interaction - OECD Interaction", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Big=1","Medium=1","Degree","Ln(Wage/Emp)", "Ocde=1", "Inter(Man*Ocde)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports, focusing on the interaction between Management and an export destination dummy according to the Organization for Economic Co-operation and Development (No Oecd = 0, Oecd = 1). If the company has exported to a country belonging to the OECD, this destination dummy is 1. Chile was excluded due to its geographic proximity. LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product).The regressions include dummies employment as a control, where 50<medium<250 workers,big>250 and small<50 is excluded by collinearity. It also has standard errors clustered by firm and fixed effects for industry and region.}"))

#Contiguity
texreg(list(m89_comp_D_2,m90_comp_D_2,m91_comp_D_2,m92_comp_D_2,m93_comp_D_2,m94_comp_D_2,m95_comp_D_2,m96_comp_D_2),caption.above = TRUE, caption="Extensive and Intensive Margins with Management and Complexity Interaction - Contiguity Interaction", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Big=1","Medium=1","Degree","Ln(Wage/Emp)", "Not Cont=1","Inter(Man*Not Cont)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports, focusing on the interaction between Management and a contiguity dummy (No Contiguity = 1, Contiguity = 0). If the company has exported to a country not contiguous to Colombia, this contiguity dummy is 1, otherwise is 0. LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product).The regressions include dummies employment as a control, where 50<medium<250 workers,big>250 and small<50 is excluded by collinearity. It also has standard errors clustered by firm and fixed effects for industry and region.}"))

#Language
texreg(list(m89_comp_D_3,m90_comp_D_3,m91_comp_D_3,m92_comp_D_3,m93_comp_D_3,m94_comp_D_3,m95_comp_D_3,m96_comp_D_3),caption.above = TRUE, caption="Extensive and Intensive Margins with Management and Complexity Interaction - Language Interaction", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Big=1","Medium=1","Degree","Ln(Wage/Emp)", "Not Spanish=1","Inter(Man*Not Span)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports,focusing on the interaction between Management and a language dummy (Not Spanish = 1, Spanish = 0). If the company has exported to a country whose language is different from Spanish, this language dummy is 1, otherwise is 0. LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product).The regressions include dummies employment as a control, where 50<medium<250 workers,big>250 and small<50 is excluded by collinearity. It also has standard errors clustered by firm and fixed effects for industry and region.}"))




```


```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis"}

#### Gravity equation with firm level data 1 (Only Exporters)

#1. Filtering for Colombia from Gravity data (info about distance, destination"s GDP,.. )
colombia_gravity<-filter(gravity,oNameFull=="Colombia")
#droping duplicated rows by destination country
colombia_gravity<-colombia_gravity[!duplicated(colombia_gravity$dNameFull), ]
#selecting key variables: 
colombia_gravity=subset(colombia_gravity, select = c(distw,contig,gdp_d,comlang_off,oNameFull,dNameFull,v,gdp_o))

## merge between expo-transaction data and Colombia-gravity data

dataexpotran<-merge(dataexpotran,colombia_gravity,by="dNameFull", all.x =TRUE)
dataexpotran<-NaRV.omit(dataexpotran)
#2.Merge with info at firm level (management, size, assest, wage per employee,...): Truncated Sample (only exporters:dataexpotran1)
dataexpotran1<-merge(dataexpotran,total[ , c("NORDEMP","Management","lnfape", "size_3","size_2","staff_with_college_degree","CIIU4","dpto","lniipe","lnwage_per_emp")],by="NORDEMP",all.x =TRUE)
dataexpotran1<-NaRV.omit(dataexpotran1)
#write_csv(dataexpotran,"~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/Export-Transaction/dataexpotran.csv")

#Pivot Table in order to aggregate fob_exports by country, which implies droping products (In Gravity equation does not matter HS products)
pivotexpotran<-aggregate(list(dataexpotran1$fob_exports_dollars), by=list(dataexpotran1$NORDEMP,dataexpotran1$dNameFull,dataexpotran1$distw,dataexpotran1$contig,dataexpotran1$gdp_d,dataexpotran1$comlang_off,dataexpotran1$dpto,dataexpotran1$size_3,dataexpotran1$size_2,dataexpotran1$staff_with_college_degree,dataexpotran1$CIIU4,dataexpotran1$lnfape,dataexpotran1$Management,dataexpotran1$lniipe,dataexpotran1$lnwage_per_emp),FUN=sum,na.rm=TRUE)

colnames(pivotexpotran)[1] <- "NORDEMP"
colnames(pivotexpotran)[2] <- "dNameFull"
colnames(pivotexpotran)[3] <- "distw"
colnames(pivotexpotran)[4] <- "contig"
colnames(pivotexpotran)[5]<-"gdp_d"
colnames(pivotexpotran)[6]<-"comlang_off"
colnames(pivotexpotran)[7] <- "dpto"
colnames(pivotexpotran)[8] <- "size_3"
colnames(pivotexpotran)[9] <- "size_2"
colnames(pivotexpotran)[10] <- "staff_with_college_degree"
colnames(pivotexpotran)[11]<-"CIIU4"
colnames(pivotexpotran)[12]<-"lnfape"
colnames(pivotexpotran)[13]<-"Management"
colnames(pivotexpotran)[14]<-"lniipe"
colnames(pivotexpotran)[15]<-"lnwage_per_emp"
colnames(pivotexpotran)[16]<-"totexp"

#Logarithms in order to estimate the gravity equation
pivotexpotran$loggdp_d<-log(pivotexpotran$gdp_d)
pivotexpotran$logdist<-log(pivotexpotran$distw)
pivotexpotran$logtotexp<-log(pivotexpotran$totexp)

m105<-miceadds::lm.cluster(logtotexp ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = pivotexpotran)

m106<-miceadds::lm.cluster(logtotexp ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+loggdp_d+logdist+comlang_off+contig+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = pivotexpotran)

m107<-miceadds::lm.cluster(logtotexp ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+loggdp_d+logdist+comlang_off+contig+I((Management*logdist))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = pivotexpotran)

m108<-miceadds::lm.cluster(logtotexp ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+loggdp_d+logdist+comlang_off+contig+I((Management*logdist))+I((Management*loggdp_d))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = pivotexpotran)

texreg(list(m105,m106,m107,m108),caption.above = TRUE, caption="Exports Revenues with country controls", fontsize = "normalsize", custom.header = list("Ln Exports"=1:4),digits =2,omit.coef =c("(Intercept)|(factor)"),custom.coef.names=c("Management","Ln(Cap/Emp)","Big=1","Medium=1","Degree","Ln(Wage/Emp)","Ln (GDP of destination)","Ln Distance","Common Language=1","Contiguous=1", "Inter(Manag*Dist)","Inter(Manag*Produc)"), custom.model.names =c("1","2","3","4"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\ This table examines the relationship between exports revenues of each country and firm's management practices. The column 1 has controls at firm level: capital per employees, dummies of size measured by employment(Big=1,Medium=1), the share of staff with college degree and the average wage.This table uses dummies of size (medium less than 250 and greater than 50 workers,big greater tha 250; small less than 50 is excluded by collinearity).The column 2 adds controls at country level: log of GDP of destination country, log of distance between the destination country and Colombia and dummies of common language and geographic contiguity.The regressions include fixed effects for industry and location and standard errors clustered by firm}"))


```

```{r echo=FALSE,warning=FALSE,message=FALSE,results="asis"}

#### Gravity equation with firm level data 2 (Using Log(1+Exp) )

#Merge with info at firm level (management, size, assest, wage per employee,...): Full Sample (exporters and No exporters:dataexpotran2)
dataexpotran2<-merge(total[ , c("NORDEMP","Management","lnfape", "size_3","size_2","staff_with_college_degree","CIIU4","dpto","lniipe","lnwage_per_emp")],dataexpotran,by="NORDEMP",all.x =TRUE)

#mode for destination
getmode <- function(dest) {
   uniqdest <- unique(dest)
   uniqdest[which.max(tabulate(match(dest, uniqdest)))]
}
dest<-dataexpotran2$dNameFull
modedest<- getmode(dest)
#print(modedest)

#mode for distance
getmode <- function(dist) {
   uniqdist <- unique(dist)
   uniqdist[which.max(tabulate(match(dist, uniqdist)))]
}
dist<-dataexpotran2$distw
modedist<- getmode(dist)
#print(modedist)

#mode for destination's GDP
getmode <- function(gdpd) {
   uniqgdpd <- unique(gdpd)
   uniqgdpd[which.max(tabulate(match(gdpd, uniqgdpd)))]
}
gdpd<-dataexpotran2$gdp_d
modegdpd<- getmode(gdpd)
#print(modegdpd)

##Replacing by mode
#destination
dataexpotran2$dNameFull[is.na(dataexpotran2$dNameFull)] <-"Ecuador"
dataexpotran2$country[is.na(dataexpotran2$country)] <-"Ecuador"
#distance
dataexpotran2$distw[is.na(dataexpotran2$distw)] <-980.4124
#destination gdp
dataexpotran2$gdp_d[is.na(dataexpotran2$gdp_d)] <-94472675328
#Common Language
dataexpotran2$comlang_off[is.na(dataexpotran2$comlang_off)] <-1
#Contiguity
dataexpotran2$contig[is.na(dataexpotran2$contig)] <-1
#Exports
dataexpotran2$fob_exports_dollars[is.na(dataexpotran2$fob_exports_dollars)] <-0

#Logarithms in order to estimate the gravity equation
dataexpotran2$loggdp_d<-log(dataexpotran2$gdp_d)
dataexpotran2$logdist<-log(dataexpotran2$distw)
dataexpotran2$logfob_exports_dollars<-log(1+dataexpotran2$fob_exports_dollars)

dataexpotran2<-subset(dataexpotran2,select=c(NORDEMP,logfob_exports_dollars,Management,lnfape,size_3,size_2,staff_with_college_degree,lnwage_per_emp,CIIU4,dpto,loggdp_d,logdist,comlang_off,contig,dNameFull))
dataexpotran2<<-NaRV.omit(dataexpotran2)

m109<-miceadds::lm.cluster(logfob_exports_dollars ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = dataexpotran2)

m110<-miceadds::lm.cluster(logfob_exports_dollars ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+loggdp_d+logdist+comlang_off+contig+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = dataexpotran2)

m111<-miceadds::lm.cluster(logfob_exports_dollars ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+loggdp_d+logdist+comlang_off+contig+I((Management*logdist))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = dataexpotran2)

m112<-miceadds::lm.cluster(logfob_exports_dollars ~Management+lnfape+size_3+size_2+staff_with_college_degree+lnwage_per_emp+loggdp_d+logdist+comlang_off+contig+I((Management*logdist))+I((Management*loggdp_d))+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = dataexpotran2)

texreg(list(m109,m110,m111,m112),caption.above = TRUE, caption="Exports Revenues with country controls-all firms", fontsize = "normalsize", custom.header = list("Ln (1+Exports)"=1:4),digits =2,omit.coef =c("(Intercept)|(factor)"),custom.coef.names=c("Management","Ln(Cap/Emp)","Big=1","Medium=1","Degree","Ln(Wage/Emp)","Ln (GDP of destination)","Ln Distance","Common Language=1","Contiguous=1", "Inter(Manag*Dist)","Inter(Manag*Produc)"), custom.model.names =c("1","2","3","4"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\ This table examines the relationship between exports revenues of each country and firm's management practices for all firms (exporters and no exporters) by using Ln (1+Exp). The column 1 has controls at firm level: capital per employees, dummies of size measured by employment(Big=1,Medium=1), the share of staff with college degree and the average wage.This table uses dummies of size (50<medium<250 workers,big>250; small<50 is excluded by collinearity).The column 2 adds controls at country level: log of GDP of destination country, log of distance between the destination country and Colombia and dummies of common language and geographic contiguity.The regressions include fixed effects for industry and location and standard errors clustered by firm}"))



```


```{r echo=FALSE,warning=(FALSE),message=FALSE,fig.show='hide',results='hide'}

set1<-subset(total,select=c(NORDEMP,Management,lnempltot,empltot,CIIU4,RDi,lnRDi_per_empl1,ipr))
write_dta(set1,"~/Google Drive/Internship_WB_Summer/Edit/Github/Data_Pulso/set1.dta")

write_dta(total,"~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/total.dta")

#fig.width = 2.5, fig.height=2.5

#graphs (three first questions)

# 1. Property

q1<-ggplot(Edit_2017_2018_2) +
  geom_bar(aes(x =property,group=1)) +
  labs(title = "Graph1.Who is the largest shareholder?",
       y="Frequency")+theme(plot.title = element_text(size = 8, face = "bold"))+theme(plot.title = element_text(hjust = 0.3))

#q1

# 2. Manager and property

Edit_2017_2018_2<-Edit_2017_2018_2%>%
  mutate(manager=ifelse(VIII2R1C1==1,"Yes","No"))

q2<-ggplot(Edit_2017_2018_2) +
  geom_bar(aes(x =factor(manager),y=..prop..,group=1)) +
  labs(title = "Is the manager the same founder or founder's family member?",
       y="Proportion",x="Manager")+theme(plot.title = element_text(size = 6, face = "bold"))+theme(plot.title = element_text(hjust = 0.3))

#q2

# 3. Gender

Edit_2017_2018_2<-Edit_2017_2018_2%>%
  mutate(gender=ifelse(VIII3R1C1==1,"Man","Woman"))

q3<-ggplot(Edit_2017_2018_2) +
  geom_bar(aes(x =factor(gender),y=..prop..,group=1)) +
  labs(title = "Manager Gender",
       x="Gender",
       y="Proportion")+theme(plot.title = element_text(hjust = 0.5))+theme(plot.title = element_text(size = 8, face = "bold"))

#q3

ggarrange(q1, q2, q3 +rremove("x.text"),
        ncol = 2, nrow = 2,widths = 0.5,heights = 0.5)+theme(plot.title = element_text(hjust = 0.5))

NORDEMP=subset(total, select = c(NORDEMP))
#write_dta(NORDEMP,"~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/NORDEMP.dta")


management_total<-total[ ,c("NORDEMP","Management","avg_non_inc_q","avg_inc_q","exports_millions","rdi_millions","productivity3")]

colnames(management_total)[7] <- "productivity_millions"

write_dta(management_total,"~/Google Drive/Internship_WB_Summer/Edit/Github/management_total.dta")

```
