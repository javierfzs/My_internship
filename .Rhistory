###new ciiu4 and dpto
dpto_ciiu4_unique<-rbind(multiplant_filter, uniplant_filter)
# Histogram Colombia - USA with only EDIT data
my.hist1<-hist(Edit_2017_2018_2$Management, ylab ="Probability", breaks=20)
my.hist1$counts
mycount1<-data.frame(my.hist1$counts)
score_bar<-data.frame(c("0.05","0.1","0.15","0.2","0.25","0.3","0.35","0.4","0.45","0.5","0.55","0.6","0.65","0.7","0.75","0.8","0.85","0.9","0.95","1"))
colnames(score_bar)[1]<-"Score"
usa_freq <-data.frame(c("0.0011","0.0016","0.0041","0.0131","0.0191","0.0251","0.0311","0.0451","0.0581", "0.0641", "0.0883", "0.0961", "0.1201","0.1161","0.1131","0.0951","0.0561","0.0221","0.0281","0.0024"))
colnames(usa_freq)[1] <- "USA"
col_freq1 <- prop.table(mycount1)
colnames(col_freq1)[1] <- "Colombia"
#df <- data.frame(, second_column)
my_over_hist1<-data.frame(score_bar,usa_freq,col_freq1)
my_over_hist1$Score<-as.numeric(as.character(unlist(my_over_hist1[[1]])))
my_over_hist1$USA<-as.numeric(as.character(unlist(my_over_hist1[[2]])))
my_over_hist1$Colombia<-as.numeric(as.character(unlist(my_over_hist1[[3]])))
#typeof(my_over_hist$Colombia)
# Plot comparing USA and Colombia Scores with all EDIT observations
library(ggplot2)
ggplot(data=my_over_hist1,aes(x=Score))+
geom_bar(aes(y=Colombia),stat="identity",position ="identity",alpha=.5,fill='black',color='red') +
geom_bar(aes(y=USA),stat="identity",position ="identity",alpha=.5,fill='white',color='blue')+
labs(title = "Manegement - Colombia vs USA with only EDIT data",
x="Score: Colombia(red) - USA(blue)",
y="Share")+theme(plot.title = element_text(hjust = 0.5))+theme(plot.title = element_text(hjust = 0.5))
# observations
#aggregating by nordemp and summing dpto or more.
# As a result, the new variable is Group.1 (KEY) instead nordemp (Nominal change) and the aggregated variable is x instead dpto.
Eam_2018_2<-aggregate(list(Eam_2018_1$CONSIN2, Eam_2018_1$ACTIVFI,Eam_2018_1$PERTOTAL,Eam_2018_1$PRODBR2,Eam_2018_1$c7c4r14,Eam_2018_1$VALAGRI,Eam_2018_1$PRESPYTE,Eam_2018_1$SALPEYTE,Eam_2018_1$VALORVEN,Eam_2018_1$VALORCOM,Eam_2018_1$VALORCX,Eam_2018_1$PORCVT), by=list(Eam_2018_1$nordemp),FUN=sum,na.rm=TRUE) #, na.rm=FALSE
#ascendent order on Group.1, it is optional becaise the aggregate function returns a ascendent Group.1 (KEY)
#Eam_2018_3<- Eam_2018_2[order(Eam_2018_2$x),]
#testing a specific value on a variable
#any(Eam_2018_3$Group.1==141465)
# returns the variable names easily
#data.frame(colnames(Eam_2018_2))
#changing names
colnames(Eam_2018_2)[1] <- "NORDEMP"
colnames(Eam_2018_2)[2] <- "intinput"
colnames(Eam_2018_2)[3] <- "fixedassets"
colnames(Eam_2018_2)[4] <- "empltot"
colnames(Eam_2018_2)[5] <- "valprod"
colnames(Eam_2018_2)[6] <- "valitc"
colnames(Eam_2018_2)[7]<-"valueadded"
colnames(Eam_2018_2)[8]<-"benefits"
colnames(Eam_2018_2)[9]<-"wages"
colnames(Eam_2018_2)[10]<-"sales"
colnames(Eam_2018_2)[11]<-"raw_material"
colnames(Eam_2018_2)[12]<-"raw_material_m"
colnames(Eam_2018_2)[13]<-"sales_x"
#typeof(Eam_2018_2$dpto)
#typeof(Eam_2018_2$periodo)
#summarise(Eam_2018_2)
#Natural join (all=FALSE, only intersection)
total <- merge(Edit_2017_2018_2,Eam_2018_2,by="NORDEMP",all=FALSE)
#Natural join with ciiu4 and dto
total<-merge(total,dpto_ciiu4_unique,by="NORDEMP",all=FALSE)
n<-data.frame(Database=c("EDIT 1:All observations","EDIT 2:At least 11 non-missing values","EAM 1:All observations","EAM 2:Collapsed data","Merge EDIT 2 - EAM 2"),n=c(nrow(Edit_2017_2018_1),nrow(Edit_2017_2018_2),nrow(Eam_2018_1),nrow(Eam_2018_2),nrow(total)))
#kable(n)%>%
#  kable_styling(position = "center")
stargazer(n,
header = FALSE,
title = "Databases",
digits = 3,
df = FALSE,
summary=FALSE,
rownames = FALSE)
# Total sales from EDIT
total$salesEdit<-total$I3R2C1+total$I3R2C1
#dataframe for Stargazer
dft2=subset(total, select = c(NORDEMP,sales,valueadded,salesEdit,sales_x,II1R10C2))#sharesales_x,sharesRDi
#Cleaning
dft2<-dft2[!(dft2$sales=="0"|dft2$salesEdit=="0"),]
dft2<-dft2%>%
mutate(sales=sales/1000)%>%
mutate(sales_x=sales_x/1000)%>%
mutate(valueadded=valueadded/1000)%>%
mutate(sharesales_x=sales_x/sales)%>%
mutate(sharesRD=II1R10C2/salesEdit)
dft2=subset(dft2, select = -c(salesEdit,sales_x,II1R10C2))
#outliers: NORDEMP=981456,144974,145804,145918 because they have outliers on RDi>0.9
dft2<-dft2[!(dft2$NORDEMP=="981456"|dft2$NORDEMP=="144974"|dft2$NORDEMP=="145804"|dft2$NORDEMP=="145918"),]
dft2=subset(dft2, select = -c(NORDEMP))
#CLEANING outliers
total<-total[!(total$NORDEMP=="981456"|total$NORDEMP=="144974"|total$NORDEMP=="145804"|total$NORDEMP=="145918"),]
colnames(dft2)[1] <- "Total Sales"
colnames(dft2)[2] <- "Value Added"
colnames(dft2)[3] <- "Exports/Sales"
colnames(dft2)[4] <- "RDi/Sales"
stargazer(dft2,
header = FALSE,
title = "Descriptive Statistics (2)",
df = FALSE,
notes.append=TRUE,
notes.align = "l",
notes = c("Note:For the merge between EDIT and EAM,this table shows the descriptive statistics for Total Sales",
"Value Added in millions of colombian pesos, value of exported products/Sales and value of investment",
"on research, development and innovation (RDi)/Sales."))
my.hist2<-hist(total$Management, ylab ="Probability", breaks=20)
my.hist2$counts
mycount2<-data.frame(my.hist2$counts)
col_freq2 <- prop.table(mycount2)
colnames(col_freq2)[1] <- "Colombia"
#df <- data.frame(, second_column)
my_over_hist2<-data.frame(score_bar,usa_freq,col_freq2)
my_over_hist2$Score<-as.numeric(as.character(unlist(my_over_hist2[[1]])))
my_over_hist2$USA<-as.numeric(as.character(unlist(my_over_hist2[[2]])))
my_over_hist2$Colombia<-as.numeric(as.character(unlist(my_over_hist2[[3]])))
# Histogram Colombia - USA with merge between EDIT - EAM
library(ggplot2)
ggplot(data=my_over_hist2,aes(x=Score))+
geom_bar(aes(y=Colombia),stat="identity",position ="identity",alpha=.5,fill='black',color='red') +
geom_bar(aes(y=USA),stat="identity",position ="identity",alpha=.5,fill='white',color='blue')+
labs(title = "Manegement - Colombia vs USA with merge EDIT - EAM data",
x="Score: Colombia(red) - USA(blue)",
y="Share")+theme(plot.title = element_text(hjust = 0.5))
##############PERFORMANCE BAR GRAPHS##################
#### Mangement and Employment###
#tranformation of employment= A company should have at least 1 employment. Just 3 cases are adjusted, from 0 to 1
total<-total%>%
mutate(empltot2=ifelse(empltot==0,1,total$empltot))
total$logempltot2<-log(total$empltot2)
#creating the log employment adjusted
total$logempltot2<-log(total$empltot2)
#listing variables to plot (Productivity,Exports, RD and i,Profit,) and some? which?
#1. Productivity (value added/employees)
total$productivity<-total$valueadded/total$empltot2
total$productivity3<-(total$productivity)/1000
#2. Value of Exports: I3R2C2
total$exports_millions<-(total$I3R2C2)/1000
#3. Investement on RD and Innovation: II1R10C2
total$rdi_millions<-(total$II1R10C2)/1000
#4. Operating profit
#a. total wages
total$totalwages<-total$benefits+total$wages
#b. Total expenses
total$totalexpenses<-total$totalwages+total$intinput
#Operating profit
total$opprofit<-total$valprod-total$totalexpenses
total$opprofit_millions<-(total$opprofit)/1000
# 5. intellectual property registers
total$ipr<-total$VI1R8C2
# 6. Wage/Empl - 2018
total$wage_per_emp<-total$totalwages/total$empltot
#7. Ln (Wage/Empl) - 2018
total$lnwage_per_emp<-log(total$wage_per_emp)
#summary(total$valueadded)
#### Decile graphs######
total$decilmanagement<-ntile(total$Management,10)
bar1<-ggplot(total, aes(x=decilmanagement, y=productivity3))+labs(x="Decile of Management", y="VA/Emp-Mill")+ stat_summary(fun = "mean",geom = "bar")
bar2<-ggplot(total, aes(x=decilmanagement, y=exports_millions))+
labs(x="Decile of Management", y="Av.Exports-Mill") +stat_summary(fun = "mean", geom = "bar")
bar3<-ggplot(total, aes(x=decilmanagement, y=rdi_millions))+
labs(x="Decile of Management", y=" Av.RDi-Mill") +stat_summary(fun = "mean", geom = "bar")
bar4<-ggplot(total, aes(x=decilmanagement, y=opprofit_millions))+
labs(x="Decile of Management", y="Av.Profit-Mill") +stat_summary(fun = "mean", geom = "bar")
bar5<-ggplot(total, aes(x=decilmanagement, y=ipr))+
labs(x="Decile of Management", y="Av.IP registers") +stat_summary(fun = "mean", geom = "bar")
bar6<-ggplot(total, aes(x=decilmanagement, y=wage_per_emp))+
labs(x="Decile of Management", y="Av.(Wage/Emp)-Miles") +stat_summary(fun = "mean", geom = "bar")
#install.packages("ggpubr")
library(ggpubr)
ggarrange(bar1, bar2, bar3 , bar4, bar5, bar6+rremove("x.text"),
ncol = 2, nrow = 3)+theme(plot.title = element_text(hjust = 0.5))
##### ggplot#####
p <- ggplot(data = total,                # specify dataset
aes(x = Management, y = logempltot2))+labs(x="Management",y="Log Employment", title="Firm size rises with Management -Non-Linear fit") + # Age on x-, Raven on y-axis
geom_point(pch = 1,size=0.05)+theme(plot.title = element_text(hjust = 0.5))
q1 <- p +
geom_smooth() # add scatterplot smoother
q1
#List of variables for Manegement score and performance FOR ALL REGRESSIONS
#With Logarithms
#1. Percent of staff_with_college_degree=staff_with_college_degree
total$staff_with_college_degree<-total$IV1R4C2/total$IV1R11C2
#2. Log (production/employees)
total$lnprod<-log(total$valprod/total$empltot)
#2B. Log (sales/employees)
total$lnsales<-log(total$sales/total$empltot)
#3. Log (total employment)=lnempltot
total$lnempltot<-log(total$empltot)
#4. Total Score (1-16)=Management
#5. Log (fixed assets / employees)=lnfape
total$lnfape<-log(total$fixedassets/total$empltot)
#6.Log (intermediate inputs/employees): lniipe
total$lniipe<-log(total$intinput/total$empltot)
##7.Profits/sales=profoversales
total$sales_millions<-total$sales/1000
total$profoversales<-total$opprofit_millions/total$sales_millions
#8.Log (Profit/sales)
total$lnprofoversales<-log(total$profoversales)
#9.Lerner Index
total$lerner<-total$opprofit/total$sales
total$ciiu4_2_d<- substr(total$CIIU4, start = 1, stop = 2)
#10. Ln production
total$lnvalprod<-log(total$valprod)
#11. Ln wages
total$lnwages<-log(total$totalwages)
#12. Ln Fix assets
total$lnfixedassets<-log(total$fixedassets)
#13. Ln Intermediate input
total$lnintinput<-log(total$intinput)
#14. log Intellectual property registers
total$lnipr<-log(1+total$ipr)
#List of variables for Drivers of Productivity variation
#With logarithms
#0. Log (Value Added/Employees)
total$log_Value_Added_per_Employee<-log(total$valueadded/total$empltot)
#1.Total Score (1-16): total$Management
#2. RDi/emp=II1R10C2/empltot
total$RDi<-total$II1R10C2
total$RDi_per_empl=(total$RDi/total$empltot)
total$RDi_per_empl1=(total$RDi_per_empl)+1
total$lnRDi_per_empl1=log(total$RDi_per_empl1) ####This the variable for RD
#3.Investment on ITC/Emp) - 2018:total$II1R4C2/total$empltot
total$ICT_per_Employee<-total$II1R4C2/total$empltot #### This the variable, since unit are miles, this means spending per 1000 workers
# Plant Management Scores and Performance (1)
#subset1
g1_1<-subset(total,select=c(NORDEMP,lnprod,lnsales,profoversales,Management,lnfape,lniipe,lnempltot,staff_with_college_degree,CIIU4,dpto))
g1_1<-NaRV.omit(g1_1)
g1_2<-subset(total,select=c(NORDEMP,lnsales,Management,lnfape,lniipe,lnempltot,staff_with_college_degree,CIIU4,dpto))
g1_2<-NaRV.omit(g1_2)
g1_3<-subset(total,select=c(NORDEMP,profoversales,Management,lnfape,lniipe,lnempltot,staff_with_college_degree,CIIU4,dpto))
g1_3<-NaRV.omit(g1_3)
m1 <- miceadds::lm.cluster(lnprod ~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree+factor(CIIU4),cluster="NORDEMP", data = g1_1)
#cor(g1_1$lnprod, g1_1$Management): 0.3284096, r2=0.1079
m2 <- miceadds::lm.cluster(lnprod ~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree+factor(dpto),cluster="NORDEMP",data = g1_1)
m3<-miceadds::lm.cluster(lnprod ~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree,cluster="NORDEMP",data=g1_1)
#Log(sales/employees)
m4 <- miceadds::lm.cluster( lnsales~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree+factor(CIIU4),cluster="NORDEMP",data = g1_2)
m5 <- miceadds::lm.cluster(lnsales ~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree+factor(dpto),cluster="NORDEMP",data = g1_2)
m6<-miceadds::lm.cluster(lnsales ~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree,cluster="NORDEMP",data=g1_2)
#Log(profit/employees)
m7 <- miceadds::lm.cluster(profoversales~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree+factor(CIIU4),cluster="NORDEMP",
data = g1_3)
m8 <- miceadds::lm.cluster(profoversales ~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree+factor(dpto),cluster="NORDEMP",data = g1_3)
m9<-miceadds::lm.cluster(profoversales ~ Management+lnfape+lniipe+lnempltot+staff_with_college_degree,cluster="NORDEMP",data=g1_3)
texreg(list(m1, m2,m3,m4,m5,m6,m7,m8,m9),caption.above = TRUE, caption="Firm Management Scores and Performance",fontsize = "small", custom.header = list("Ln(Output/Emp)"=1:3,"Ln(Sales/Emp)"=4:6, "Profit/Sales"=7:9),digits =2,omit.coef =c("(Intercept)|(factor)"),custom.coef.names=c("Management","Ln(Cap/Emp)", "Ln(Input/Emp)", "Ln(Employment)","Degree"), custom.model.names =c("1","2","3","4","5","6","7","8","9"),custom.note = ("\\parbox{0.95\\linewidth}{\\vspace{3pt}%stars. \\\\OLS coefficients with standard errors in parentheses (clustered at firm level). The management score is the unweighted average of the score for each of the 16 questions, where each question is first normalized to be on a 0–1 scale. The sample is all EDIT observations with at least 11 non-missing responses to management questions and a successful match to EAM, which have positive value added, positive employment, and positive imputed capital. The columns 1-3 mean the models with Industry Fixed Effects, Location Fixed Effects and no Fixed Effects, respectively.This also applies for columns 4-6 and 7-9. The regressions include clustered standard errors by CIIU4 and region, depending on the fixed effect applied}"))
# Plant Management Scores and Performance (2)
#subset2
g2_1<-subset(total,select=c(NORDEMP,log_Value_Added_per_Employee,Management,lnfape,lnempltot,staff_with_college_degree,CIIU4,dpto))
g2_1<-NaRV.omit(g2_1)
g2_2<-subset(total,select=c(NORDEMP,lnipr,Management,lnfape,lnempltot,staff_with_college_degree,CIIU4,dpto))
g2_2<-NaRV.omit(g2_2)
g2_3<-subset(total,select=c(NORDEMP,lnRDi_per_empl1,Management,lnfape,lnempltot,staff_with_college_degree,CIIU4,dpto))
g2_3<-NaRV.omit(g2_3)
#FE:yes, with ciiu4. Dependent Variable: Log (Value Added/Employees)
m13 <- miceadds::lm.cluster(log_Value_Added_per_Employee ~ Management + lnfape+lnempltot+staff_with_college_degree+factor(CIIU4),cluster = "NORDEMP", data = g2_1)
m14 <- miceadds::lm.cluster(log_Value_Added_per_Employee ~ Management + lnfape+lnempltot+staff_with_college_degree+factor(dpto), cluster = "NORDEMP",data = g2_1)
#FE:No
m15<-miceadds::lm.cluster(log_Value_Added_per_Employee ~ Management + lnfape+lnempltot+staff_with_college_degree,cluster="NORDEMP", data =g2_1)
#FE:yes, with ciiu4. Dependent Variable:Log(Profits/sales)
m16 <- miceadds::lm.cluster(lnipr ~ Management + lnfape+lnempltot+staff_with_college_degree+factor(CIIU4),cluster = "NORDEMP",data = g2_2)
m17 <- miceadds::lm.cluster(lnipr ~ Management + lnfape+lnempltot+staff_with_college_degree+factor(dpto), cluster="NORDEMP",data = g2_2)
#FE:No
m18<-miceadds::lm.cluster(lnipr ~ Management + lnfape+lnempltot+staff_with_college_degree,cluster="NORDEMP",data =g2_2)
#FE:yes, with ciiu4. Dependent Variable:RDi
m19 <- miceadds::lm.cluster(lnRDi_per_empl1~ Management + lnfape+lnempltot+staff_with_college_degree+factor(CIIU4),cluster = "NORDEMP", data = g2_3)
#FE:yes, with ciiu4. Dependent Variable:RDi
m20 <- miceadds::lm.cluster(lnRDi_per_empl1~ Management + lnfape+lnempltot+staff_with_college_degree+factor(dpto),cluster = "NORDEMP",data = g2_3)
#FE:No
m21<-miceadds::lm.cluster(lnRDi_per_empl1~ Management + lnfape+lnempltot+staff_with_college_degree,cluster = "NORDEMP",data =g2_3)
texreg(list(m13, m14,m15,m16,m17,m18,m19,m20,m21),caption.above = TRUE, caption="Firm Management Scores and Performance",fontsize = "small",   custom.header = list("Log(VA/Emp)"=1:3,"Log(1+IP Registers)"=4:6, "Log(1+RDi/Emp)"=7:9),digits =2, omit.coef =c("(Intercept)|(factor)"),custom.coef.names=c("Management","Ln(Cap/Emp)","Ln(Employment)","Degree"), custom.model.names =c("1","2","3","4","5","6","7","8","9"),custom.note = ("\\parbox{0.95\\linewidth}{\\vspace{3pt}%stars. \\\\OLS coefficients with standard errors in parentheses. The management score is the unweighted average of the score for each of the 16 questions, where each question is first normalized to be on a 0–1 scale. The sample is all EDIT observations with at least 11 non-missing responses to management questions and a successful match to EAM, which have positive value added, positive employment, and positive imputed capital. The columns 1-3 mean the models with Industry Fixed Effects, Location Fixed Effects and no Fixed Effects, respectively.This also applies for columns 4-6 and 7-9.The regressions include clustered standard errors by CIIU4 and region, depending on the fixed effect applied}"))
# Regression for Drivers of Productivity Variation (dpv)
#IV1R11C2: total personal employed
#II1R10C2:Investment on RDi
#II1R4C2:Investment on ITC
#in order to replace NA by zeroes
g3_subset<-subset(total,select=c(NORDEMP,log_Value_Added_per_Employee,Management,lnRDi_per_empl1,ICT_per_Employee,staff_with_college_degree))
g3_1<-g3_subset
g3_1$lnRDi_per_empl1[is.na(g3_subset$lnRDi_per_empl1)] <- 0
g3_1$ICT_per_Employee[is.na(g3_subset$ICT_per_Employee)] <-256.7
g3_1<-NaRV.omit(g3_1)
reg_dpvlog1<-miceadds::lm.cluster(log_Value_Added_per_Employee ~ Management, cluster="NORDEMP", data =g3_1)
reg_dpvlog2<-miceadds::lm.cluster(log_Value_Added_per_Employee ~ Management+lnRDi_per_empl1,cluster="NORDEMP", data =g3_1)
reg_dpvlog3<-miceadds::lm.cluster(log_Value_Added_per_Employee ~ Management+lnRDi_per_empl1+ICT_per_Employee,cluster="NORDEMP", data =g3_1)
reg_dpvlog4<-miceadds::lm.cluster(log_Value_Added_per_Employee ~ Management+lnRDi_per_empl1+ICT_per_Employee+staff_with_college_degree,cluster="NORDEMP", data =g3_1)
texreg(list(reg_dpvlog1, reg_dpvlog2,reg_dpvlog3,reg_dpvlog4),caption.above = TRUE, caption="Drivers of Productivity Variation",fontsize = "normalsize", custom.header = list("Log(VA/Emp)"=1:4),digits =3,omit.coef =c("(Intercept)|(factor)"),custom.coef.names=c("Management","RDi", "ICT/Emp","Degree"), custom.model.names =c("1","2","3","4"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\OLS coefficients with standard errors in parentheses.Dependent variable is firm level log(Value Added/Employment). Independent variables are Management score, RDi is measured as log(1+RDi intensity), where RDi intensity is the total domestic Research, Development and innovation expenditure in 2018 divided by total domestic employment, ICT/Emp is investment per worker (spending on information and communication technology hardware and software per employee), Degree is measured by the share of employees (managers and non-managers) with a college degree.Missing values have been replaced by zero for RDi and by means for the other variables. The regressions include standard errors clustered by firm}"))
# TFP and Tariffs (Jozef Konings and Mary Amiti-2005: Trade Liberalization, Intermediate Inputs and Productivity:)
#source:
#average tariffs: https://www.macmap.org/
# ciiu-product: https://www.dane.gov.co/index.php/sistema-estadistico-nacional-sen/normas-y-estandares/nomenclaturas-y-clasificaciones/tablas-correlativas
tarciiu<- read_csv("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/Tariffs_CIIU4.csv")
avgtarciiu<-data.frame(aggregate( avgtariff ~ CIIU4,tarciiu, mean ))
total <- merge(total,avgtarciiu,by="CIIU4",all=FALSE)
#Subset
g3a<-subset(total,select=c(NORDEMP,lnvalprod,lnwages,lnfixedassets,lnintinput))
g3a<-NaRV.omit(g3a)
mtfp_reg<-lm(lnvalprod ~ lnwages+lnfixedassets+lnintinput,data =g3a)
g3a$p_lnvalprod<-predict(mtfp_reg)
g3a$lna<-g3a$lnvalprod-g3a$p_lnvalprod
#including TFP in Total
total<-merge(total,g3a[ , c("NORDEMP","lna")],by="NORDEMP",all.x =TRUE)
# reading weighted input tariffs
wit<- read_csv("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/weighted_input_tariffs.csv")
total<-merge(total,wit,by="ciiu4_2_d",all.x=TRUE)
total<-total%>%
relocate(ciiu4_2_d, .before = wit)
#Total Factor Productivity (tfp)
#LogY:lnvalprod
#LogL:lnwages
#LogK:lnfixedassets
#LogI:lnintinput
m41a<-miceadds::lm.cluster(lna~ avgtariff+wit,data=total,cluster = "CIIU4")
texreg(list(m41a),caption.above = TRUE, caption="TFP at firm level and Tariffs",fontsize = "normalsize", custom.header = list("Revenue-based Total Factor Productivity"=1),digits =3,omit.coef ="Intercept",custom.coef.names=c("Average Output Tariff","Weighted Input Tariff"), custom.model.names =c("1"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\OLS coefficients with standard errors in parentheses.Dependent variable is firm level Total Factor Productivity. According to Konings and Amiti(2005),independent variables are the Average Output Tariff and Weighted Input Tariff. The Average Tariff is the average of the tariffs according to the CIIU 4 code of the firm, using the data from International Trade Center ITC: macmap.org.Since tariffs are classified HS codes, we use a table from DANE, which has an equivalence between HS codes and CIIU4, published in: https://www.dane.gov.co/index.php/sistema-estadistico-nacional-sen/normas-y-estandares/nomenclaturas-y-clasificaciones/tablas-correlativas, trade section. For the Weighted Input Tariff, we use the imported input -output matrix (IIOM) published by DANE: https://www.dane.gov.co/index.php/estadisticas-por-tema/cuentas-nacionales/cuentas-nacionales-anuales/matrices-complementarias, (2015). Since IOM does not use CIIU4 codes, we elaborate a concordance table between IIOM activities and two or three digits CIIU4 levels. The average tariff of these two or three digits CIIU4 levels is weighted by the IIOM and subsequently matched to the firm two or three digits CIIU4 codes. The concordance table is in the annex. The regressions include clustered standard errors by four digits CIIU4 codes}"))
####Product Market Competition and Management ####
g4<-subset(total,select=c(NORDEMP,Management,lerner))
g4<-NaRV.omit(g4)
g5<-subset(total,select=c(NORDEMP,Management,lna,lerner,lnfape,lnempltot,staff_with_college_degree,CIIU4))
g5<-NaRV.omit(g5)
m22<-lm( Management ~ lerner,data =g4)
#FE industry 4 digits and all controls
m23 <- plm(Management ~ lerner+lnfape+lnempltot+staff_with_college_degree,
index = c("CIIU4"),
effect = "individual",
model = "within",
data = g5)
rob_se3 <- list(sqrt(diag(vcovHC(m22, type = "HC1"))),
sqrt(diag(vcovHC(m23, type = "HC1"))))
texreg(list(m22, m23),caption.above = TRUE, caption="Product Market Competition and Management", fontsize = "normalsize", custom.header = list("Management"=1:2),digits =3,override.se = rob_se3,  omit.coef ="Intercept",custom.coef.names=c("Lerner Index","Ln(Cap/Emp)", "Ln(Employment","Degree"), custom.model.names =c("1","2"),custom.note = ("\\parbox{0.6\\linewidth}{\\vspace{3pt}%stars. \\\\The Lerner Index is the gross profits over sales, where gross profits equals to production value less material costs and wage costs in 2018.This table uses this Lerner index without controls:column (1), and with four-digit industry fixed effects and full controls:column (2). The regressions include robust standard errors by four digits CIIU4 codes}"))
#Drivers of Total Factor Productivity
g6<-merge(g5,g3_subset[ , c("NORDEMP","lnRDi_per_empl1","ICT_per_Employee")],by="NORDEMP",all.x=TRUE)
g6_b<-NaRV.omit(g6)
g6$lnRDi_per_empl1[is.na(g6$lnRDi_per_empl1)] <- 0
g6$ICT_per_Employee[is.na(g6$ICT_per_Employee)] <-256.7
#Revenue-based Total Factor Productivity
m24<-miceadds::lm.cluster(lna ~ Management,cluster="NORDEMP", data=g6,)
m25<-miceadds::lm.cluster(lna ~ Management+lnRDi_per_empl1,cluster="NORDEMP", data =g6)
m26<-miceadds::lm.cluster(lna ~ Management+lnRDi_per_empl1+ICT_per_Employee,cluster="NORDEMP", data=g6)
m27<-miceadds::lm.cluster(lna ~ Management+lnRDi_per_empl1+ICT_per_Employee+staff_with_college_degree,cluster="NORDEMP", data =g6)
texreg(list(m24, m25,m26,m27),caption.above = TRUE, caption="Drivers of Total Factor Productivity", fontsize = "normalsize", custom.header = list("Revenue-based Total Factor Productivity - RTFP"=1:4),digits =3,omit.coef ="Intercept",custom.coef.names=c("Management","RDi", "ICT/Emp","Degree"), custom.model.names =c("1","2","3","4"),custom.note = ("\\parbox{0.9\\linewidth}{\\vspace{3pt}%stars. \\\\OLS coefficients with standard errors in parentheses. Dependent variable is firm level TFP built from industry firm-level. Independent variables are management score, RDi measured as log(1+RDi intensity) where RDi intensity is the total domestic RDi expenditure divided by total domestic employment, IT investment per worker, skill measured by the share of employees (managers and non-managers) with a college
degree.Missing values have been replaced by zero for RDi and by means for the other variables.The regressions include robust standard errors}"))
##Market Competition and Management
#average by 2 digits - CIIU4
total$avgtariff_2 <- ave(total$avgtariff, total$ciiu4_2_d)
total<-total%>%
relocate(avgtariff, .before = wit)
impo_china_ciiu4<-read_dta("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/impo_china_ciiu4.dta")
total <- merge(total,impo_china_ciiu4,by="CIIU4",all.x=TRUE)
total<-total%>%
relocate( CIIU4,.before = ciiu4_2_d)
#anyNA(total$avgtariff)
g7<-subset(total,select=c(NORDEMP,Management,avgtariff,wit,lnfape,lnempltot,staff_with_college_degree,CIIU4,lerner,chshare,dpto))
g7<-NaRV.omit(g7)
m28<-miceadds::lm.cluster( Management ~ lerner+factor(dpto),data =g7,cluster="CIIU4")
m29 <- miceadds::lm.cluster(Management ~lerner+avgtariff+factor(dpto),data = g7, cluster="CIIU4")
m29a <- miceadds::lm.cluster(Management ~lerner+avgtariff+wit+factor(dpto),data = g7, cluster="CIIU4")
m30<-miceadds::lm.cluster(Management ~lerner+avgtariff+wit+I((lerner*avgtariff))+factor(dpto), cluster="CIIU4",data =g7)
m31<-miceadds::lm.cluster(Management ~lerner+avgtariff+wit+I((lerner*avgtariff))+lnfape+lnempltot+staff_with_college_degree+factor(dpto),cluster="CIIU4",data =g7)
texreg(list(m28, m29,m29a,m30,m31),caption.above = TRUE, caption="Market Competition and Management", fontsize = "normalsize", custom.header = list("Management"=1:5),digits =3,omit.coef =c("(Intercept)|(factor)"),custom.coef.names=c("Lerner Index","Average Output Tariff","Weighted input Tariff", "Inter Lerner*Tariff","Ln(Cap/Emp)", "Ln(Employment)","Degree"), custom.model.names =c("1","2","3","4","5"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\Lerner Index is the gross profits over sales, where gross profits equals to production value less material costs and wage costs in 2018.The Average Tariff is the average of the tariffs according to the CIIU 4 code of the firm, using the data from International Trade Center ITC: macmap.org.Since tariffs are classified HS codes, we use a table from DANE, which has an equivalence between HS codes and CIIU4, published in: https://www.dane.gov.co/index.php/sistema-estadistico-nacional-sen/normas-y-estandares/nomenclaturas-y-clasificaciones/tablas-correlativas, trade section. For the Weighted Input Tariff, we use the imported input -output matrix (IIOM) published by DANE: https://www.dane.gov.co/index.php/estadisticas-por-tema/cuentas-nacionales/cuentas-nacionales-anuales/matrices-complementarias, (2015). Since IOM does not use CIIU4 codes, we elaborate a concordance table between IIOM activities and two or three digits CIIU4 levels. The average tariff of these two or three digits CIIU4 levels is weighted by the IIOM and subsequently matched to the firm two or three digits CIIU4 codes. The concordance table is in the annex. The last column of this regression table includes  a interaction between Lerner Index and Average Output Tariff and full controls. All regressions have Location Fixed Effects by department in Colombia and clustered standard errors by CIIU 4.}"))
#Chinese imports
m28b<-miceadds::lm.cluster( Management ~ chshare,cluster="CIIU4",data =g7)
m29b <- miceadds::lm.cluster(Management ~chshare+lnfape+lnempltot+staff_with_college_degree,cluster="CIIU4",data = g7)
texreg(list(m28b, m29b),caption.above = TRUE, caption="China Import Share and Management", fontsize = "normalsize", custom.header = list("Management"=1:2),digits =3,omit.coef ="Intercept",custom.coef.names=c("China Import Share","Ln(Cap/Emp)", "Ln(Employment)","Degree"), custom.model.names =c("1","2"),custom.note = ("\\parbox{0.9\\linewidth}{\\vspace{3pt}%stars. \\\\The China Import Share means imports from China / Total imports for each industry (4 digits CIIU rev4). This table uses this China Import Share without controls:column (1), and with full controls:column (2). We estimated the China Import Share according to the Import Origin published by DANE and matched them to the firm four digits CIIU4 codes.The regressions include clustered standard errors by four digits CIIU4 codes.}"))
#Gravity Equation a country level using World Managemt Survey (do not erase, just hide)
gravity<-read_dta("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/gravity_2013_2015.dta")
gravity2015<-gravity[(gravity$year=="2015"),]
gravity2014<-gravity[(gravity$year=="2014"),]
managementwms<- read_csv("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/managementwms.csv")
gravity2014<-merge(gravity2014,managementwms,by="oNameFull",all.x = TRUE)
gravity2015<-merge(gravity2015,managementwms,by="oNameFull",all.x = TRUE)
gravity2014$lnexp<-log(gravity2014$v)
gravity2014$lngdp_o<-log(gravity2014$gdp_o)
gravity2014$lngdp_d<-log(gravity2014$gdp_d)
gravity2014$lndistw<-log(gravity2014$distw)
gravity2015$lnexp<-log(gravity2015$v)
gravity2015$lngdp_o<-log(gravity2015$gdp_o)
gravity2015$lngdp_d<-log(gravity2015$gdp_d)
gravity2015$lndistw<-log(gravity2015$distw)
#without Management, some controls for all countries
m31a<-lm(lnexp ~lngdp_o+lngdp_d+lndistw+contig+comlang_off,data = gravity2015)
#Management sample
grav_eq<-subset(gravity2015,select=c(year,oNameFull,dNameFull,v,iso_d,iso_o,gdp_o,gdp_d,distw,contig,comlang_off,comcol,colony,col45,comcur, comrelig,lnexp,lngdp_o,lngdp_d,lndistw,managementwms))
grav_eq<-NaRV.omit(grav_eq)
######### without Management, some controls for Management Sample ########
m31b<-lm(lnexp ~lngdp_o+lngdp_d+lndistw+contig+comlang_off,data = grav_eq)
######### with Management, some controls for Management Sample ########
m31c<-miceadds::lm.cluster(lnexp ~lngdp_o+lngdp_d+lndistw+contig+comlang_off+managementwms,cluster= managementwms,data = grav_eq)
texreg(list(m31b, m31c),caption.above = TRUE, caption="Gravity Equation and Management", fontsize = "normalsize", custom.header = list("Ln Exports"=1:2),digits =3,omit.coef ="Intercept",custom.coef.names=c("Ln Exporter's GDP","Ln Importer's GDP", "Ln Distance-km", "Contiguous=1","Common Language=1","Management"), custom.model.names =c("1","2"),custom.note = ("\\parbox{0.9\\linewidth}{\\vspace{3pt}%stars. \\\\This table estimates a gravity model, where the dependent variable is Exporter's GDP, and the independent variables are: Importer's GDP, Distance in kilometers between exporter and importer and the average of Exporter's Management. The sample includes 34 countries in 2015, with data from World Management Survey. The regression calculates clustered standard errors by average Exporter's Management}"))
# Homogeneous and Heterogeneous Products
##Listing variables Trade and Management
#Logarithms
total$lnsales_x<-log(1+total$sales_x)
total$lniraw_m<-log(1+total$raw_material_m)
total$lntrade<-log(1+total$sales_x+total$raw_material_m)
#count(total,"shareraw_m")
#anyNA(total$shareraw_m)
##Shares
total$sharesales_x<-total$sales_x/total$sales
total$shareraw_m<-total$raw_material_m/total$raw_material
total$sharetrade<-(total$sales_x+total$raw_material_m)/(total$sales+total$raw_material)
#Dummies
#xer: Exporter
#mer: Importer
#traded: Exporter or Importer
total<-total %>%
mutate(xer = if_else(sales_x >0, 1,0))%>%
mutate(mer = if_else(raw_material_m >0, 1,0))%>%
mutate(traded=if_else(sales_x+raw_material_m>0,1,0))
rauch<- read_csv("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/Rauch/cpc_vs_ciiu4_.csv")
rauch_unique<-rauch[!duplicated(rauch$CIIU4), ]
total<-merge(total,rauch_unique,by="CIIU4",all.x = TRUE)
#count(total,"LIBERAL")
total<-total%>%
mutate(dummy_diff=ifelse(LIBERAL=="n",1,0))
g10<-subset(total,select=c(NORDEMP,lnsales_x,lniraw_m,lntrade,Management,dummy_diff,dpto,lnfape,lnempltot,staff_with_college_degree,CIIU4))
g10<-NaRV.omit(g10)
m31d<-miceadds::lm.cluster(lnsales_x ~Management+I((Management*dummy_diff))+dummy_diff+lnfape+lnempltot+staff_with_college_degree+factor(dpto),cluster="CIIU4",data = g10)
texreg(list(m31d),caption.above = TRUE, caption="Differentiated Products and Management", fontsize = "normalsize",digits =3,custom.coef.names=c("Management","Inter Manag*Diff","Differentiated=1", "Ln(Cap/Emp)","Ln(Employment)","Degree"), custom.model.names =c("Log(1+Exports)"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between logartithm of (1+value of exported products) at firm level and firm's management practices.It includes  a interaction between Management and a Dummy of Differentiated Product:Inter Manag*Diff= 1 when the firm product is differentiated and O otherwise, using Rauch clasiffication. Since Rauch(1999) classifies products at the level of 4 digits of industry, this table assumes that the firm produces only one good, either homogeneous or differentiated, according to its industry(CIIU rev4).In addition, it includes full controls: Ln(Cap/Emp), Ln(Employment) and the percent of staff with college degree. Since Rauch classification used 3 and digit SITC rev.2 levels, we use a concordance table from DANE, which has an equivalence between SITC.rev2 (CPC ver 2.0 in Spanish) and CIIU rev 4, published in: https://www.dane.gov.co/index.php/sistema-estadistico-nacional-sen/normas-y-estandares/nomenclaturas-y-clasificaciones/tablas-correlativas, trade section. The regressions include clustered standard errors by four digits CIIU4 codes}"))
# dummies TRADE REGRESSIONS (Exports, Imports, Export+Import=Trade. This uses EAM survey data, no expo-transaction)
g8<-subset(total,select=c(NORDEMP,xer,mer,traded,lnsales_x,lniraw_m,lntrade,Management,dpto,lnfape,lnempltot,staff_with_college_degree,CIIU4))
g8<-NaRV.omit(g8)
#Dummies
m35<-miceadds::lm.cluster(xer ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g8)
m36<-miceadds::lm.cluster(mer ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g8)
m37<-miceadds::lm.cluster(traded ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g8)
texreg(list(m35,m36,m37),caption.above = TRUE, caption="Dummies of trade outcomes and Management", fontsize = "normalsize",digits =3,custom.coef.names=c("Management","Ln(Cap/Emp)","Ln(Employment)","Degree"), custom.model.names =c("Dummy Exports","Dummy Imports","Dummy Trade"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between export status (Dummy Exports = 1 if value of exported products>0 and 0 otherwise), import status (Dummy Import=1 if value of imported inputs>0 and 0 otherwise), trade status (Dummy Trade=1 if value of exports + imports>0 and 0 otherwise) and firm's management practices.It includes some controls: Ln(Cap/Emp), Ln(Employment) and the percent of staff with college degree. All regressions include fixed effects for firm location (department) and 4 digits - CIIU 4 (industry) and clustered standard errors by firm.}"))
#Trade Outcomes (logs and Shares)
#Logarithms
m32<-miceadds::lm.cluster(lnsales_x ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),data = g8,cluster = "NORDEMP")
m33<-miceadds::lm.cluster(lniraw_m ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g8)
m34<-miceadds::lm.cluster(lntrade ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g8)
texreg(list(m32, m33,m34),caption.above = TRUE, caption="Logarithms of trade outcomes and Management", fontsize = "normalsize",digits =3,custom.coef.names=c("Management","Ln(Cap/Emp)","Ln(Employment)","Degree"), custom.model.names =c("Log(1+Exports)","Log(1+Imports)","Log(1+Exports+Imports)"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{0.8\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between logartithm of (1+value of exported products), logarithm of (1+value of imported inputs) and logarithm of (1+value of exported products + imported inputs) at firm level and firm's management practices.It includes some controls: Ln(Cap/Emp), Ln(Employment) and the percent of staff with college degree. All regressions include fixed effects for firm location (department) and 4 digits - CIIU 4 (industry) and clustered standard errors by firm.}"))
#Share REGRESSION
g9<-subset(total,select=c(NORDEMP,sharesales_x,shareraw_m,sharetrade,Management,dpto,lnfape,lnempltot,staff_with_college_degree,CIIU4))
g9<-NaRV.omit(g9)
m38<-miceadds::lm.cluster(sharesales_x ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g9)
m39<-miceadds::lm.cluster(shareraw_m ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g9)
m40<-miceadds::lm.cluster(sharetrade ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g9)
texreg(list(m38,m39,m40),caption.above = TRUE, caption="Shares of trade outcomes and Management", fontsize = "normalsize",digits =3,custom.coef.names=c("Management","Ln(Cap/Emp)","Ln(Employment)","Degree"), custom.model.names =c("Share of exported products","Share of imported inputs","Share of traded"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between Share of exported products = exports/total sales, Share of imported inputs=imports/total inputs, Share of traded=(exports+imports)/(total sales + inputs) and firm's management practices.It includes some controls: Ln(Cap/Emp), Ln(Employment) and the percent of staff with college degree. All regressions include fixed effects for firm location (department) and 4 digits - CIIU 4 (industry) and clustered standard errors by firm.}"))
#Expo-transaction, hidden because it is replaced for more specific tables - DO NOT ERASE
expotran<- read_csv("~/Google Drive/Internship_WB_Summer/Edit/Github/My_internship/Export-Transaction/lnexpocount.csv")
total<-merge(total,expotran,by="NORDEMP",all.x = TRUE)
g11<-subset(total,select=c(NORDEMP,lncount_destiny,lncount_products,lncount_dest_prod,lnexport2018,lnexport2018_per_dest,lnexport2018_per_prod,lnexport2018_per_dest_prod,lntop_dest_prod,Management,dpto,lnfape,lnempltot,staff_with_college_degree,lnwage_per_emp,CIIU4))
g11<-NaRV.omit(g11)
m42<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m43<-miceadds::lm.cluster(lncount_products ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m44<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m45<-miceadds::lm.cluster(lnexport2018_per_dest_prod ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m46<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+lnempltot+staff_with_college_degree+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
texreg(list(m42,m43,m44,m45,m46),caption.above = TRUE, caption="Extensive and Intensive Margins of Exports", fontsize = "normalsize",digits =3,custom.coef.names=c("Management","Ln(Cap/Emp)","Ln(Empl)","Degree"), custom.model.names =c("Log Dest","Log Prod","Log DestProd", "Log Exp/DestProd", "Log Exp TopDestProd"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports. The regressions have fixed effects by four digits CIIU4 and Location. Standard errors clustered by firm.}"))
#Expo-transaction 1
#Without employment without fixed effects, with clustered SE by firm
m47<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m48<-miceadds::lm.cluster(lncount_products ~Management+lnfape+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m49<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m49a<-miceadds::lm.cluster(lnexport2018~Management+lnfape+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m50<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m51<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m52<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m53<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
#WithOUT employment with fixed effects, with clustered SE by firm
m54<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m55<-miceadds::lm.cluster(lncount_products ~Management+lnfape+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m56<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m56a<-miceadds::lm.cluster(lnexport2018 ~Management+lnfape+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m57<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m58<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m59<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m60<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
texreg(list(m47,m48,m49,m49a,m50,m51,m52,m53),caption.above = TRUE, caption="Extensive and Intensive Margins - No employment and No fixed effects", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Degree","Ln(Wage/Emp)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports. LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product).The regressions have standard errors clustered by firm.}"))
texreg(list(m54,m55,m56,m56a,m57,m58,m59,m60),caption.above = TRUE, caption="Extensive and Intensive Margins - No Employment and Fixed Effects, ", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Degree","Ln(Wage/Emp)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports.LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product).The regressions have fixed effects by four digits CIIU4 and location and standard errors clustered by firm.}"))
###Expo-transaction 2
# employment, no fixed effects, with clustered SE by firm
m61<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m62<-miceadds::lm.cluster(lncount_products ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m63<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m63a<-miceadds::lm.cluster(lnexport2018 ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m64<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m65<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m66<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
m67<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g11)
#With employment with fixed effects, with clustered SE by firm
m68<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp++factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m69<-miceadds::lm.cluster(lncount_products ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m70<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m70a<-miceadds::lm.cluster(lnexport2018 ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m71<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m72<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m73<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
m74<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+lnempltot+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g11)
texreg(list(m61,m62,m63,m63a,m64,m65,m66,m67),caption.above = TRUE, caption="Extensive and Intensive Margins - With employment, No fixed effects", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Ln(Empl)","Degree","Ln(Wage/Emp)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1.1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports. LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product). The regressions include employment as a control and have standard errors clustered by firm.}"))
texreg(list(m68,m69,m70,m70a,m71,m72,m73,m74),caption.above = TRUE, caption="Extensive and Intensive Margins - With Employment and Fixed Effects and ", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Ln(Empl)","Degree","Ln(Wage/Emp)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firms' management practices and the extensive and intensive margins of their exports. LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product).The regressions have standard errors clustered by firm.}"))
# Expo transaction with employment dummies
total<-total%>%
mutate(size=recode(empltot,"0:50='Small';51:250='Medium';else='Big'"))
total <- dummy_cols(total, select_columns = 'size')
g12<-subset(total,select=c(NORDEMP,lncount_destiny,lncount_products,lncount_dest_prod,lnexport2018,lnexport2018_per_dest,lnexport2018_per_prod,lnexport2018_per_dest_prod,lntop_dest_prod,Management,dpto,lnfape,lnempltot,staff_with_college_degree,CIIU4,lnfape,size_Big,size_Medium,size_Small,lnwage_per_emp))
g12<-NaRV.omit(g12)
# employment, no fixed effects, with clustered SE by firm
m75<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+size_Big+size_Medium+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g12)
m76<-miceadds::lm.cluster(lncount_products ~Management+lnfape+size_Big+size_Medium+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g12)
m77<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+size_Big+size_Medium+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g12)
m77a<-miceadds::lm.cluster(lnexport2018~Management+lnfape+size_Big+size_Medium+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g12)
m78<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+size_Big+size_Medium+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g12)
m79<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+size_Big+size_Medium+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g12)
m80<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+size_Big+size_Medium+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g12)
m81<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+size_Big+size_Medium+staff_with_college_degree+lnwage_per_emp,cluster = "NORDEMP",data = g12)
texreg(list(m75,m76,m77,m77a,m78,m79,m80,m81),caption.above = TRUE, caption="Extensive and Intensive Margins - With employment Dummies, No fixed effects", fontsize = "normalsize",digits =2,custom.coef.names=c("Management","Ln(Cap/Emp)","Big=1","Medium=1","Degree","Ln(Wage/Emp)"), custom.model.names =c("LnD","LnP","LnD-P","LnExp", "LnExp/D","Ln Exp/P", "Ln Exp/D-P", "Ln TopD-P"),omit.coef =c("(Intercept)|(factor)"),custom.note = ("\\parbox{1.1\\linewidth}{\\vspace{3pt}%stars. \\\\This table examines the relationship between firm's management practices and the extensive and intensive margins of their exports. LnD:Log of destinations,LnP:Log of products by HS 6 digits,LnD-P: Log of pairs destination-products,LnExp: Log of Exports, LnExp/D: Log(Exports/Destinations,Ln Exp/P:Log(Exports/Products),Ln Exp/D-P:Log(Exports/pairs destination-products),Ln TopD-P:Log(exports in a firm's highest-revenue destination-product).The regressions include dummies employment as a control, where 50<medium<250 workers,big>250 and small<50 is excluded by collinearity .It also has standard errors clustered by firm.}"))
### EXPO-TRANSACTION (Final Table)
#With employment dummies with fixed effects, with clustered SE by firm
m82<-miceadds::lm.cluster(lncount_destiny ~Management+lnfape+size_Big+size_Medium+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12)
m83<-miceadds::lm.cluster(lncount_products ~Management+lnfape+size_Big+size_Medium+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12)
m84<-miceadds::lm.cluster(lncount_dest_prod ~Management+lnfape+size_Big+size_Medium+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12)
m84a<-miceadds::lm.cluster(lnexport2018 ~Management+lnfape+size_Big+size_Medium+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12)
m85<-miceadds::lm.cluster(lnexport2018_per_dest~Management+lnfape+size_Big+size_Medium+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12)
m86<-miceadds::lm.cluster(lnexport2018_per_prod~Management+lnfape+size_Big+size_Medium+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12)
m87<-miceadds::lm.cluster(lnexport2018_per_dest_prod~Management+lnfape+size_Big+size_Medium+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12)
m88<-miceadds::lm.cluster(lntop_dest_prod ~Management+lnfape+size_Big+size_Medium+staff_with_college_degree+lnwage_per_emp+factor(CIIU4)+factor(dpto),cluster = "NORDEMP",data = g12)
#merge with whole (original) expo-transaction data at levels
total<-merge(total,expocount,by="NORDEMP",all.x = TRUE)
View(df0)
