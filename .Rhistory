#kable(n)%>%
#  kable_styling(position = "center")
stargazer(n,
header = FALSE,
title = "Databases",
digits = 3,
df = FALSE,
summary=FALSE,
rownames = FALSE)
#install.packages("stargazer")
my.hist2<-hist(total$Management, ylab ="Probability", breaks=20)
my.hist2$counts
mycount2<-data.frame(my.hist2$counts)
col_freq2 <- prop.table(mycount2)
colnames(col_freq2)[1] <- "Colombia"
#df <- data.frame(, second_column)
my_over_hist2<-data.frame(score_bar,usa_freq,col_freq2)
my_over_hist2$Score<-as.numeric(as.character(unlist(my_over_hist2[[1]])))
my_over_hist2$USA<-as.numeric(as.character(unlist(my_over_hist2[[2]])))
my_over_hist2$Colombia<-as.numeric(as.character(unlist(my_over_hist2[[3]])))
# Histogram Colombia - USA with merge between EDIT - EAM
library(ggplot2)
ggplot(data=my_over_hist2,aes(x=Score))+
geom_bar(aes(y=Colombia),stat="identity",position ="identity",alpha=.5,fill='black',color='red') +
geom_bar(aes(y=USA),stat="identity",position ="identity",alpha=.5,fill='white',color='blue')+
labs(title = "Manegement - Colombia vs USA with merge EDIT - EAM data",
x="Score: Colombia(red) - USA(blue)",
y="Share")+theme(plot.title = element_text(hjust = 0.5))
#### Mangement and Employment###
#tranformation of employment= A company should have at least 1 employment. Just 3 cases are adjusted, from 0 to 1
total<-total%>%
mutate(empltot2=ifelse(empltot==0,1,total$empltot))
total$logempltot2<-log(total$empltot2)
#creating the log employment adjusted
total$logempltot2<-log(total$empltot2)
##### ggplot#####
p <- ggplot(data = total,                # specify dataset
aes(x = Management, y = logempltot2))+labs(x="Management",y="Log Employment", title="Firm size rises with Management -Non-Linear fit") + # Age on x-, Raven on y-axis
geom_point(pch = 1,size=0.05)+theme(plot.title = element_text(hjust = 0.5))
q1 <- p +
geom_smooth() # add scatterplot smoother
q1
#install.packages("StatMeasures")
library(StatMeasures)
#listing variables to plot (Productivity,Exports, R&D and i,Profit,) and some? which?
#1. Productivity (Production/employees)
total$productivity<-log(total$valprod/total$empltot)
#2. Value of Exports: I3R2C2
#3. Investement on R&D and Innovation: II1R10C2
#4. Operating profit
#a. total wages
total$totalwages<-total$benefits+total$monthly_wages
View(total)
knitr::opts_chunk$set(echo = TRUE)
#install.packages("stargazer")
library(tidyverse)
library(ggplot2)
library(stargazer)
library(dplyr)
library(kableExtra)
library(xtable)
library("knitr")
library("papeR")
library("devtools")
require(plyr)
library(haven)
Edit_2017_2018_1 <- read_dta("~/Google Drive/Internship_WB_Summer/Edit/DataEditM2017-2018/Edit 2017_2018_recoded.dta")
####Cleaning for managers-frequency review. If No key performance indicators (from question 2), question 3 will be zero
#(if VIII5R1C1_new=0 (Dane:VIII5R1C1=5), VIII6R1C1_new,VIII7R1C1_new, VIII8R1C1_new should be = 0)
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII6R1C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R1C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII6R2C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R2C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII6R3C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R3C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII6R4C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R4C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII6R5C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R5C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII6R6C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R6C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII6R7C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R7C1_new))
#Cleaning for no-managers-frequency-review. If No key performance indicators (from question 2), question 4 will be zero
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII7R1C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R1C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII7R2C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R2C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII7R3C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R3C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII7R4C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R4C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII7R5C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R5C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII7R6C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R6C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII7R7C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R7C1_new))
#### AVERAGE score for managers-frequency review, question 3
Edit_2017_2018_1$VIII6_new_avg_score = rowMeans(Edit_2017_2018_1[,c(680,681,682,683,684,685,686)],na.rm = TRUE)
#### AVERAGE score for no Managers-frequency review, question 4
Edit_2017_2018_1$VIII7_new_avg_score = rowMeans(Edit_2017_2018_1[,c(687,688,689,690,691,692,693)],na.rm = TRUE)
#### AVERAGE score for non-managers’ performance bonuses based on, question 9
Edit_2017_2018_1$VIII12_new_avg_score = rowMeans(Edit_2017_2018_1[,c(700,701,702,703,704)],na.rm = TRUE)
#### AVERAGE score for managers’ performance bonuses usually based on, question 11
Edit_2017_2018_1$VIII14_new_avg_score = rowMeans(Edit_2017_2018_1[,c(706,707,708,709,710)],na.rm = TRUE)
Edit_2017_2018_1$VIII10R1C1_new <- replace(Edit_2017_2018_1$VIII10R1C1_new, Edit_2017_2018_1$VIII10R1C1_new == 6, NA)
#VIII19R1C1, question property
Edit_2017_2018_1$property<-as.character(Edit_2017_2018_1$VIII1R1C1)
Edit_2017_2018_1$property<-revalue(Edit_2017_2018_1$property,c("1"="Founder","2"="Founder's Familiy","3"="Other"))
#Edit_2017_2018_1$property<-as.numeric(Edit_2017_2018_1$property)
#this lines to identify number of column and variable
#data.frame(colnames(Edit_2017_2018_1))
#variable:column number:question number (1-16 - Bloom (2019))
# VIII4R1C1_new=678=q1, VIII5R1C1_new=679=q2,VIII6_new_avg_score=694=q3,VIII7_new_avg_score=695=q4,VIII8R1C1_new=696=q5
#VIII9R1C1_new=697=q6,VIII10R1C1_new=698=q7,VIII11R1C1_new=699=q8,VIII12_new_avg_score=716=q9,VIII13R1C1_new=705=q10
# VIII14_new_avg_score=717=q11,VIII15R1C1_new=711=q12,VIII16R1C1_new=712=q13,VIII17R1C1_new=713=q14,
#VIII18R1C1_new=714=q15,VIII19R1C1_new=715=q16
# counting missing values accross 16 questions
Edit_2017_2018_1$na_16_q<-rowSums(is.na(Edit_2017_2018_1[, c(678,679,694,695,696,697,698,699,716,705,717,711,712,713,714,715)]))
#filtering the data set: From 16 Bloom Questions,at least 11 non-missing values (max 5 missing values)
Edit_2017_2018_2 <- Edit_2017_2018_1[Edit_2017_2018_1$na_16_q <=5,]
#Management Score, Non-incentives and incentives questions
# 1. Total Average (16 questions)
Edit_2017_2018_2$Management = rowMeans(Edit_2017_2018_2[,c(678,679,694,695,696,697,698,699,716,705,717,711,712,713,714,715)],na.rm = TRUE)
# 2.Non-incentives average (1-8 questions)
Edit_2017_2018_2$avg_non_inc_q = rowMeans(Edit_2017_2018_2[,c(678,679,694,695,696,697,698,699)],na.rm = TRUE)
# 3.Incentives average (9-16 questions)
Edit_2017_2018_2$avg_inc_q = rowMeans(Edit_2017_2018_2[,c(716,705,717,711,712,713,714,715)],na.rm = TRUE)
#Descriptive Statistics
library(haven)
#reading Annual Manufacturing Survey from Colombia
Eam_2018_1 <- read_dta("~/Google Drive/Internship_WB_Summer/EAM/EAM_2018/EAM_2018_30june.dta")
###proportion of multiplants
count_nordemp_eam<-data.frame(count(Eam_2018_1,"nordemp"))
count_nordemp_eam<-count_nordemp_eam %>%
mutate(Multiplant = if_else(freq >1, 1,0))
### exporters###
Edit_2017_2018_2<-Edit_2017_2018_2 %>%
mutate(Exporters = if_else(I3R2C2 >1, 1,0))
####reshape
#require(reshape2)
#mat$id <- rownames(mat)
#melt(mat)
##dataframe for stargazer
df0<-data.frame(Edit_2017_2018_2$NORDEMP,Edit_2017_2018_2$Management,Edit_2017_2018_2$avg_non_inc_q,Edit_2017_2018_2$avg_inc_q,Edit_2017_2018_2$IV1R11C2,Edit_2017_2018_2$Exporters)
colnames(df0)[1] <- "nordemp"
colnames(df0)[2] <- "Management (1-16)"
colnames(df0)[3] <- "No Incentives (1-8)"
colnames(df0)[4] <- "Incentives (9-16)"
colnames(df0)[5]<-"Size(Firm employment)"
colnames(df0)[6]<-"Exporters"
df0 <- merge(df0,count_nordemp_eam,by="nordemp",all=FALSE)
df0=subset(df0, select = -c(nordemp,freq))
stargazer(df0,
header = FALSE,
title = "Descriptive Statistics",
digits = 3,
df = FALSE)
# Histogram Colombia - USA with only EDIT data
my.hist1<-hist(Edit_2017_2018_2$Management, ylab ="Probability", breaks=20)
my.hist1$counts
mycount1<-data.frame(my.hist1$counts)
score_bar<-data.frame(c("0.05","0.1","0.15","0.2","0.25","0.3","0.35","0.4","0.45","0.5","0.55","0.6","0.65","0.7","0.75","0.8","0.85","0.9","0.95","1"))
colnames(score_bar)[1]<-"Score"
usa_freq <-data.frame(c("0.0011","0.0016","0.0041","0.0131","0.0191","0.0251","0.0311","0.0451","0.0581", "0.0641", "0.0883", "0.0961", "0.1201","0.1161","0.1131","0.0951","0.0561","0.0221","0.0281","0.0024"))
colnames(usa_freq)[1] <- "USA"
col_freq1 <- prop.table(mycount1)
colnames(col_freq1)[1] <- "Colombia"
#df <- data.frame(, second_column)
my_over_hist1<-data.frame(score_bar,usa_freq,col_freq1)
my_over_hist1$Score<-as.numeric(as.character(unlist(my_over_hist1[[1]])))
my_over_hist1$USA<-as.numeric(as.character(unlist(my_over_hist1[[2]])))
my_over_hist1$Colombia<-as.numeric(as.character(unlist(my_over_hist1[[3]])))
#typeof(my_over_hist$Colombia)
# Plot comparing USA and Colombia Scores
library(ggplot2)
ggplot(data=my_over_hist1,aes(x=Score))+
geom_bar(aes(y=Colombia),stat="identity",position ="identity",alpha=.5,fill='black',color='red') +
geom_bar(aes(y=USA),stat="identity",position ="identity",alpha=.5,fill='white',color='blue')+
labs(title = "Manegement - Colombia vs USA with only EDIT data",
x="Score: Colombia(red) - USA(blue)",
y="Share")+theme(plot.title = element_text(hjust = 0.5))+theme(plot.title = element_text(hjust = 0.5))
# observations
#aggregating by nordemp and summing dpto or more.
# As a result, the new variable is Group.1 (KEY) instead nordemp (Nominal change) and the aggregated variable is x instead dpto.
Eam_2018_2<-aggregate(list(Eam_2018_1$CONSIN2, Eam_2018_1$ACTIVFI,Eam_2018_1$PERTOTAL,Eam_2018_1$PRODBR2,Eam_2018_1$c7c4r14,Eam_2018_1$VALAGRI), by=list(Eam_2018_1$nordemp,Eam_2018_1$PRESPYTE,Eam_2018_1$SALPEYTE,Eam_2018_1$VALORVEN),FUN=sum,na.rm=TRUE) #, na.rm=FALSE
#ascendent order on Group.1, it is optional becaise the aggregate function returns a ascendent Group.1 (KEY)
#Eam_2018_3<- Eam_2018_2[order(Eam_2018_2$x),]
#testing a specific value on a variable
#any(Eam_2018_3$Group.1==141465)
# returns the variable names easily
#data.frame(colnames(Eam_2018_2))
#changing names
colnames(Eam_2018_2)[1] <- "NORDEMP"
colnames(Eam_2018_2)[2] <- "intinput"
colnames(Eam_2018_2)[3] <- "fixedassets"
colnames(Eam_2018_2)[4] <- "empltot"
colnames(Eam_2018_2)[5] <- "valprod"
colnames(Eam_2018_2)[6] <- "valitc"
colnames(Eam_2018_2)[7]<-"valueadded"
colnames(Eam_2018_2)[8]<-"benefits"
colnames(Eam_2018_2)[9]<-"monthly_wages"
colnames(Eam_2018_2)[9]<-"sales"
#typeof(Eam_2018_2$dpto)
#typeof(Eam_2018_2$periodo)
#summarise(Eam_2018_2)
#Natural join (all=FALSE, only intersection)
total <- merge(Edit_2017_2018_2,Eam_2018_2,by="NORDEMP",all=FALSE)
n<-data.frame(Database=c("EDIT 1:All observations","EDIT 2:At least 11 non-missing values","EAM 1:All observations","EAM 2:Collapsed data","Merge EDIT 2 - EAM 2"),n=c(nrow(Edit_2017_2018_1),nrow(Edit_2017_2018_2),nrow(Eam_2018_1),nrow(Eam_2018_2),nrow(total)))
#kable(n)%>%
#  kable_styling(position = "center")
stargazer(n,
header = FALSE,
title = "Databases",
digits = 3,
df = FALSE,
summary=FALSE,
rownames = FALSE)
#install.packages("stargazer")
my.hist2<-hist(total$Management, ylab ="Probability", breaks=20)
my.hist2$counts
mycount2<-data.frame(my.hist2$counts)
col_freq2 <- prop.table(mycount2)
colnames(col_freq2)[1] <- "Colombia"
#df <- data.frame(, second_column)
my_over_hist2<-data.frame(score_bar,usa_freq,col_freq2)
my_over_hist2$Score<-as.numeric(as.character(unlist(my_over_hist2[[1]])))
my_over_hist2$USA<-as.numeric(as.character(unlist(my_over_hist2[[2]])))
my_over_hist2$Colombia<-as.numeric(as.character(unlist(my_over_hist2[[3]])))
# Histogram Colombia - USA with merge between EDIT - EAM
library(ggplot2)
ggplot(data=my_over_hist2,aes(x=Score))+
geom_bar(aes(y=Colombia),stat="identity",position ="identity",alpha=.5,fill='black',color='red') +
geom_bar(aes(y=USA),stat="identity",position ="identity",alpha=.5,fill='white',color='blue')+
labs(title = "Manegement - Colombia vs USA with merge EDIT - EAM data",
x="Score: Colombia(red) - USA(blue)",
y="Share")+theme(plot.title = element_text(hjust = 0.5))
#### Mangement and Employment###
#tranformation of employment= A company should have at least 1 employment. Just 3 cases are adjusted, from 0 to 1
total<-total%>%
mutate(empltot2=ifelse(empltot==0,1,total$empltot))
total$logempltot2<-log(total$empltot2)
#creating the log employment adjusted
total$logempltot2<-log(total$empltot2)
##### ggplot#####
p <- ggplot(data = total,                # specify dataset
aes(x = Management, y = logempltot2))+labs(x="Management",y="Log Employment", title="Firm size rises with Management -Non-Linear fit") + # Age on x-, Raven on y-axis
geom_point(pch = 1,size=0.05)+theme(plot.title = element_text(hjust = 0.5))
q1 <- p +
geom_smooth() # add scatterplot smoother
q1
#install.packages("StatMeasures")
library(StatMeasures)
#listing variables to plot (Productivity,Exports, R&D and i,Profit,) and some? which?
#1. Productivity (Production/employees)
total$productivity<-log(total$valprod/total$empltot)
#2. Value of Exports: I3R2C2
#3. Investement on R&D and Innovation: II1R10C2
#4. Operating profit
#a. total wages
total$totalwages<-total$benefits+total$monthly_wages
View(total)
knitr::opts_chunk$set(echo = TRUE)
#install.packages("stargazer")
library(tidyverse)
library(ggplot2)
library(stargazer)
library(dplyr)
library(kableExtra)
library(xtable)
library("knitr")
library("papeR")
library("devtools")
require(plyr)
library(haven)
Edit_2017_2018_1 <- read_dta("~/Google Drive/Internship_WB_Summer/Edit/DataEditM2017-2018/Edit 2017_2018_recoded.dta")
####Cleaning for managers-frequency review. If No key performance indicators (from question 2), question 3 will be zero
#(if VIII5R1C1_new=0 (Dane:VIII5R1C1=5), VIII6R1C1_new,VIII7R1C1_new, VIII8R1C1_new should be = 0)
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII6R1C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R1C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII6R2C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R2C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII6R3C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R3C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII6R4C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R4C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII6R5C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R5C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII6R6C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R6C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII6R7C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII6R7C1_new))
#Cleaning for no-managers-frequency-review. If No key performance indicators (from question 2), question 4 will be zero
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII7R1C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R1C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII7R2C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R2C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII7R3C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R3C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII7R4C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R4C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII7R5C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R5C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII7R6C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R6C1_new))
Edit_2017_2018_1 <- Edit_2017_2018_1 %>%
mutate(VIII7R7C1_new = ifelse(VIII5R1C1_new== 0, 0, VIII7R7C1_new))
#### AVERAGE score for managers-frequency review, question 3
Edit_2017_2018_1$VIII6_new_avg_score = rowMeans(Edit_2017_2018_1[,c(680,681,682,683,684,685,686)],na.rm = TRUE)
#### AVERAGE score for no Managers-frequency review, question 4
Edit_2017_2018_1$VIII7_new_avg_score = rowMeans(Edit_2017_2018_1[,c(687,688,689,690,691,692,693)],na.rm = TRUE)
#### AVERAGE score for non-managers’ performance bonuses based on, question 9
Edit_2017_2018_1$VIII12_new_avg_score = rowMeans(Edit_2017_2018_1[,c(700,701,702,703,704)],na.rm = TRUE)
#### AVERAGE score for managers’ performance bonuses usually based on, question 11
Edit_2017_2018_1$VIII14_new_avg_score = rowMeans(Edit_2017_2018_1[,c(706,707,708,709,710)],na.rm = TRUE)
Edit_2017_2018_1$VIII10R1C1_new <- replace(Edit_2017_2018_1$VIII10R1C1_new, Edit_2017_2018_1$VIII10R1C1_new == 6, NA)
#VIII19R1C1, question property
Edit_2017_2018_1$property<-as.character(Edit_2017_2018_1$VIII1R1C1)
Edit_2017_2018_1$property<-revalue(Edit_2017_2018_1$property,c("1"="Founder","2"="Founder's Familiy","3"="Other"))
#Edit_2017_2018_1$property<-as.numeric(Edit_2017_2018_1$property)
#this lines to identify number of column and variable
#data.frame(colnames(Edit_2017_2018_1))
#variable:column number:question number (1-16 - Bloom (2019))
# VIII4R1C1_new=678=q1, VIII5R1C1_new=679=q2,VIII6_new_avg_score=694=q3,VIII7_new_avg_score=695=q4,VIII8R1C1_new=696=q5
#VIII9R1C1_new=697=q6,VIII10R1C1_new=698=q7,VIII11R1C1_new=699=q8,VIII12_new_avg_score=716=q9,VIII13R1C1_new=705=q10
# VIII14_new_avg_score=717=q11,VIII15R1C1_new=711=q12,VIII16R1C1_new=712=q13,VIII17R1C1_new=713=q14,
#VIII18R1C1_new=714=q15,VIII19R1C1_new=715=q16
# counting missing values accross 16 questions
Edit_2017_2018_1$na_16_q<-rowSums(is.na(Edit_2017_2018_1[, c(678,679,694,695,696,697,698,699,716,705,717,711,712,713,714,715)]))
#filtering the data set: From 16 Bloom Questions,at least 11 non-missing values (max 5 missing values)
Edit_2017_2018_2 <- Edit_2017_2018_1[Edit_2017_2018_1$na_16_q <=5,]
#Management Score, Non-incentives and incentives questions
# 1. Total Average (16 questions)
Edit_2017_2018_2$Management = rowMeans(Edit_2017_2018_2[,c(678,679,694,695,696,697,698,699,716,705,717,711,712,713,714,715)],na.rm = TRUE)
# 2.Non-incentives average (1-8 questions)
Edit_2017_2018_2$avg_non_inc_q = rowMeans(Edit_2017_2018_2[,c(678,679,694,695,696,697,698,699)],na.rm = TRUE)
# 3.Incentives average (9-16 questions)
Edit_2017_2018_2$avg_inc_q = rowMeans(Edit_2017_2018_2[,c(716,705,717,711,712,713,714,715)],na.rm = TRUE)
#Descriptive Statistics
library(haven)
#reading Annual Manufacturing Survey from Colombia
Eam_2018_1 <- read_dta("~/Google Drive/Internship_WB_Summer/EAM/EAM_2018/EAM_2018_30june.dta")
###proportion of multiplants
count_nordemp_eam<-data.frame(count(Eam_2018_1,"nordemp"))
count_nordemp_eam<-count_nordemp_eam %>%
mutate(Multiplant = if_else(freq >1, 1,0))
### exporters###
Edit_2017_2018_2<-Edit_2017_2018_2 %>%
mutate(Exporters = if_else(I3R2C2 >1, 1,0))
####reshape
#require(reshape2)
#mat$id <- rownames(mat)
#melt(mat)
##dataframe for stargazer
df0<-data.frame(Edit_2017_2018_2$NORDEMP,Edit_2017_2018_2$Management,Edit_2017_2018_2$avg_non_inc_q,Edit_2017_2018_2$avg_inc_q,Edit_2017_2018_2$IV1R11C2,Edit_2017_2018_2$Exporters)
colnames(df0)[1] <- "nordemp"
colnames(df0)[2] <- "Management (1-16)"
colnames(df0)[3] <- "No Incentives (1-8)"
colnames(df0)[4] <- "Incentives (9-16)"
colnames(df0)[5]<-"Size(Firm employment)"
colnames(df0)[6]<-"Exporters"
df0 <- merge(df0,count_nordemp_eam,by="nordemp",all=FALSE)
df0=subset(df0, select = -c(nordemp,freq))
stargazer(df0,
header = FALSE,
title = "Descriptive Statistics",
digits = 3,
df = FALSE)
# Histogram Colombia - USA with only EDIT data
my.hist1<-hist(Edit_2017_2018_2$Management, ylab ="Probability", breaks=20)
my.hist1$counts
mycount1<-data.frame(my.hist1$counts)
score_bar<-data.frame(c("0.05","0.1","0.15","0.2","0.25","0.3","0.35","0.4","0.45","0.5","0.55","0.6","0.65","0.7","0.75","0.8","0.85","0.9","0.95","1"))
colnames(score_bar)[1]<-"Score"
usa_freq <-data.frame(c("0.0011","0.0016","0.0041","0.0131","0.0191","0.0251","0.0311","0.0451","0.0581", "0.0641", "0.0883", "0.0961", "0.1201","0.1161","0.1131","0.0951","0.0561","0.0221","0.0281","0.0024"))
colnames(usa_freq)[1] <- "USA"
col_freq1 <- prop.table(mycount1)
colnames(col_freq1)[1] <- "Colombia"
#df <- data.frame(, second_column)
my_over_hist1<-data.frame(score_bar,usa_freq,col_freq1)
my_over_hist1$Score<-as.numeric(as.character(unlist(my_over_hist1[[1]])))
my_over_hist1$USA<-as.numeric(as.character(unlist(my_over_hist1[[2]])))
my_over_hist1$Colombia<-as.numeric(as.character(unlist(my_over_hist1[[3]])))
#typeof(my_over_hist$Colombia)
# Plot comparing USA and Colombia Scores
library(ggplot2)
ggplot(data=my_over_hist1,aes(x=Score))+
geom_bar(aes(y=Colombia),stat="identity",position ="identity",alpha=.5,fill='black',color='red') +
geom_bar(aes(y=USA),stat="identity",position ="identity",alpha=.5,fill='white',color='blue')+
labs(title = "Manegement - Colombia vs USA with only EDIT data",
x="Score: Colombia(red) - USA(blue)",
y="Share")+theme(plot.title = element_text(hjust = 0.5))+theme(plot.title = element_text(hjust = 0.5))
# observations
#aggregating by nordemp and summing dpto or more.
# As a result, the new variable is Group.1 (KEY) instead nordemp (Nominal change) and the aggregated variable is x instead dpto.
Eam_2018_2<-aggregate(list(Eam_2018_1$CONSIN2, Eam_2018_1$ACTIVFI,Eam_2018_1$PERTOTAL,Eam_2018_1$PRODBR2,Eam_2018_1$c7c4r14,Eam_2018_1$VALAGRI), by=list(Eam_2018_1$nordemp,Eam_2018_1$PRESPYTE,Eam_2018_1$SALPEYTE,Eam_2018_1$VALORVEN),FUN=sum,na.rm=TRUE) #, na.rm=FALSE
#ascendent order on Group.1, it is optional becaise the aggregate function returns a ascendent Group.1 (KEY)
#Eam_2018_3<- Eam_2018_2[order(Eam_2018_2$x),]
#testing a specific value on a variable
#any(Eam_2018_3$Group.1==141465)
# returns the variable names easily
#data.frame(colnames(Eam_2018_2))
#changing names
colnames(Eam_2018_2)[1] <- "NORDEMP"
colnames(Eam_2018_2)[2] <- "intinput"
colnames(Eam_2018_2)[3] <- "fixedassets"
colnames(Eam_2018_2)[4] <- "empltot"
colnames(Eam_2018_2)[5] <- "valprod"
colnames(Eam_2018_2)[6] <- "valitc"
colnames(Eam_2018_2)[7]<-"valueadded"
colnames(Eam_2018_2)[8]<-"benefits"
colnames(Eam_2018_2)[9]<-"monthly_wages"
colnames(Eam_2018_2)[10]<-"sales"
#typeof(Eam_2018_2$dpto)
#typeof(Eam_2018_2$periodo)
#summarise(Eam_2018_2)
#Natural join (all=FALSE, only intersection)
total <- merge(Edit_2017_2018_2,Eam_2018_2,by="NORDEMP",all=FALSE)
n<-data.frame(Database=c("EDIT 1:All observations","EDIT 2:At least 11 non-missing values","EAM 1:All observations","EAM 2:Collapsed data","Merge EDIT 2 - EAM 2"),n=c(nrow(Edit_2017_2018_1),nrow(Edit_2017_2018_2),nrow(Eam_2018_1),nrow(Eam_2018_2),nrow(total)))
#kable(n)%>%
#  kable_styling(position = "center")
stargazer(n,
header = FALSE,
title = "Databases",
digits = 3,
df = FALSE,
summary=FALSE,
rownames = FALSE)
#install.packages("stargazer")
my.hist2<-hist(total$Management, ylab ="Probability", breaks=20)
my.hist2$counts
mycount2<-data.frame(my.hist2$counts)
col_freq2 <- prop.table(mycount2)
colnames(col_freq2)[1] <- "Colombia"
#df <- data.frame(, second_column)
my_over_hist2<-data.frame(score_bar,usa_freq,col_freq2)
my_over_hist2$Score<-as.numeric(as.character(unlist(my_over_hist2[[1]])))
my_over_hist2$USA<-as.numeric(as.character(unlist(my_over_hist2[[2]])))
my_over_hist2$Colombia<-as.numeric(as.character(unlist(my_over_hist2[[3]])))
# Histogram Colombia - USA with merge between EDIT - EAM
library(ggplot2)
ggplot(data=my_over_hist2,aes(x=Score))+
geom_bar(aes(y=Colombia),stat="identity",position ="identity",alpha=.5,fill='black',color='red') +
geom_bar(aes(y=USA),stat="identity",position ="identity",alpha=.5,fill='white',color='blue')+
labs(title = "Manegement - Colombia vs USA with merge EDIT - EAM data",
x="Score: Colombia(red) - USA(blue)",
y="Share")+theme(plot.title = element_text(hjust = 0.5))
#### Mangement and Employment###
#tranformation of employment= A company should have at least 1 employment. Just 3 cases are adjusted, from 0 to 1
total<-total%>%
mutate(empltot2=ifelse(empltot==0,1,total$empltot))
total$logempltot2<-log(total$empltot2)
#creating the log employment adjusted
total$logempltot2<-log(total$empltot2)
##### ggplot#####
p <- ggplot(data = total,                # specify dataset
aes(x = Management, y = logempltot2))+labs(x="Management",y="Log Employment", title="Firm size rises with Management -Non-Linear fit") + # Age on x-, Raven on y-axis
geom_point(pch = 1,size=0.05)+theme(plot.title = element_text(hjust = 0.5))
q1 <- p +
geom_smooth() # add scatterplot smoother
q1
#install.packages("StatMeasures")
library(StatMeasures)
#listing variables to plot (Productivity,Exports, R&D and i,Profit,) and some? which?
#1. Productivity (Production/employees)
total$productivity<-total$valprod/total$empltot
#2. Value of Exports: I3R2C2
#3. Investement on R&D and Innovation: II1R10C2
#4. Operating profit
#a. total wages
total$totalwages<-total$benefits+total$monthly_wages
#b. Total expenses
total$totalexpenses<-total$totalwages+total$intinput
#Operating profit
total$opprofit<-total$valprod-total$totalexpenses
#### Decile graphs######
total$decilproductivity<-ntile(total$productivity,10)
total$decilvalexp<-ntile(total$I3R2C2,10)
total$decilrdi<-ntile(total$II1R10C2, 10)
total$decilopprofit<-ntile(total$opprofit, 10)
test_quant <- test %>%
group_by(is_open) %>%
do(x = seq(0, 1, 0.1),
quant = quantile(.$stars, seq(0, 1, 0.1))) %>%
unnest()
#install.packages("StatMeasures")
library(StatMeasures)
#listing variables to plot (Productivity,Exports, R&D and i,Profit,) and some? which?
#1. Productivity (Production/employees)
total$productivity<-total$valueadded/total$empltot
#2. Value of Exports: I3R2C2
#3. Investement on R&D and Innovation: II1R10C2
#4. Operating profit
#a. total wages
total$totalwages<-total$benefits+total$monthly_wages
#b. Total expenses
total$totalexpenses<-total$totalwages+total$intinput
#Operating profit
total$opprofit<-total$valprod-total$totalexpenses
#### Decile graphs######
total$decilmanagement<-ntile(total$Management,10)
ggplot(data=total,aes(x=decilmanagement))+geom_bar(aes(y=productivity),alpha=.5,fill='black',color='red')+labs(title = "Manegement - Colombia vs USA with merge EDIT - EAM data",x="Management", y="Productivity")+theme(plot.title = element_text(hjust = 0.5))
ggplot(data=total,aes(x=decilmanagement))+labs(title = "Manegement - Colombia vs USA with merge EDIT - EAM data",x="Management", y="Productivity")+theme(plot.title = element_text(hjust = 0.5))
bp <- ggbarplot(total, x = "decilmanagement", y = "productivity",
fill = "cyl",               # change fill color by cyl
color = "white",            # Set bar border colors to white
palette = "jco",            # jco journal color palett. see
x.text.angle = 90           # Rotate vertically x axis texts
)
if(!require(devtools)) install.packages("devtools")
devtools::install_github("kassambara/ggpubr")
